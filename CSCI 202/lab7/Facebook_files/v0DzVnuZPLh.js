/*1368815635,173217599*/

if (self.CavalryLogger) { CavalryLogger.start_js(["xk\/ia"]); }

__d("DOMWrapper",[],function(a,b,c,d,e,f){var g,h,i={setRoot:function(j){g=j;},getRoot:function(){return g||document.body;},setWindow:function(j){h=j;},getWindow:function(){return h||self;}};e.exports=i;});
__d("Flash",["DOMWrapper","QueryString","UserAgent","copyProperties","guid"],function(a,b,c,d,e,f){var g=b('DOMWrapper'),h=b('QueryString'),i=b('UserAgent'),j=b('copyProperties'),k=b('guid'),l={},m,n=g.getWindow().document;function o(t){var u=n.getElementById(t);if(u)u.parentNode.removeChild(u);delete l[t];}function p(){for(var t in l)if(l.hasOwnProperty(t))o(t);}function q(t){return t.replace(/\d+/g,function(u){return '000'.substring(u.length)+u;});}function r(t){if(!m){if(i.ie()>=9)window.attachEvent('onunload',p);m=true;}l[t]=t;}var s={embed:function(t,u,v,w){var x=k();t=encodeURI(t);v=j({allowscriptaccess:'always',flashvars:w,movie:t},v||{});if(typeof v.flashvars=='object')v.flashvars=h.encode(v.flashvars);var y=[];for(var z in v)if(v.hasOwnProperty(z)&&v[z])y.push('<param name="'+encodeURI(z)+'" value="'+encodeURI(v[z])+'">');var aa=n.createElement('div'),ba='<object '+(i.ie()?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ':'type="application/x-shockwave-flash"')+'data="'+t+'" '+'id="'+x+'">'+y.join('')+'</object>';aa.innerHTML=ba;var ca=u.appendChild(aa.firstChild);r(x);return ca;},remove:o,getVersion:function(){var t='Shockwave Flash',u='application/x-shockwave-flash',v='ShockwaveFlash.ShockwaveFlash',w;if(navigator.plugins&&typeof navigator.plugins[t]=='object'){var x=navigator.plugins[t].description;if(x&&navigator.mimeTypes&&navigator.mimeTypes[u]&&navigator.mimeTypes[u].enabledPlugin)w=x.match(/\d+/g);}if(!w)try{w=(new ActiveXObject(v)).GetVariable('$version').match(/(\d+),(\d+),(\d+),(\d+)/);w=Array.prototype.slice.call(w,1);}catch(y){}return w;},checkMinVersion:function(t){var u=s.getVersion();if(!u)return false;return q(u.join('.'))>=q(t);},isAvailable:function(){return !!s.getVersion();}};e.exports=s;});
__d("MercuryAudioPlayer",["Event","Arbiter","DOM","Flash","copyProperties"],function(a,b,c,d,e,f){var g=b('Event'),h=b('Arbiter'),i=b('DOM'),j=b('Flash'),k=b('copyProperties'),l=200;function m(){var v=i.create('audio'),w=false;try{if(!!v.canPlayType)if(v.canPlayType('video/mp4;').replace(/^no$/,''))w=true;}finally{return w;}}function n(){return j.isAvailable();}var o=function(){this.interval=null;this.arbiterInstance=null;this.audio=i.create('audio');g.listen(this.audio,'playing',function(){this.informAttachment('playing',this.audio.currentTime);this.interval=setInterval(function(){this.informAttachment('playing',this.audio.currentTime);}.bind(this),l);}.bind(this));g.listen(this.audio,'ended',function(){clearInterval(this.interval);this.informAttachment('finished');}.bind(this));};k(o.prototype,{setAudio:function(v,w){this.audio.setAttribute('src',v);this.arbiterInstance=w;},informAttachment:function(v,w){if(this.arbiterInstance)this.arbiterInstance.inform(v,w);},play:function(){this.audio.play();this.informAttachment('played');},resume:function(){this.audio.play();this.informAttachment('played');},pause:function(){this.audio.pause();clearInterval(this.interval);this.informAttachment('paused');},getType:function(){return 'html5';}});var p=function(){this.src=null;this.arbiterInstance=null;var v=i.create('div');document.body.appendChild(v);this.swf=j.embed('/swf/SoundStreamPlayer.swf',v,null,{});this.interval=null;h.subscribe('soundstream/finished',function(){clearInterval(this.interval);this.informAttachment('finished');}.bind(this));};k(p.prototype,{setAudio:function(v,w){this.src=v;this.arbiterInstance=w;},informAttachment:function(v,w){if(this.arbiterInstance)this.arbiterInstance.inform(v,w);},play:function(){this.swf.playSound(this.src);this.interval=setInterval(function(){var v=this.swf.getCurrentTime();this.informAttachment('playing',v);}.bind(this),l);this.informAttachment('played');},resume:function(){this.swf.resume();this.informAttachment('played');},pause:function(){clearInterval(this.interval);this.swf.pause();this.informAttachment('paused');},getType:function(){return 'flash';}});function q(){if(m()){return new o();}else if(n())return new p();return false;}var r=null,s=null,t=0;function u(v,w){this.src=v;this.arbiterInstance=w;this.audio_id=++t;r!==null||(r=q());if(!r)return false;}k(u.prototype,{getType:function(){if(!r){return false;}else return r.getType();},play:function(v){if(v&&s==this.audio_id){r.resume();}else{this.pause();s=this.audio_id;r.setAudio(this.src,this.arbiterInstance);r.play();}},pause:function(){r.pause();}});e.exports=u;});
__d("MercuryAttachmentAudioClip.react",["ReactDOM","Arbiter","ArbiterMixin","MercuryAudioPlayer","Env","JSLogger","LeftRight.react","React","cx","shield","tx"],function(a,b,c,d,e,f){var g=b('ReactDOM'),h=b('Arbiter'),i=b('ArbiterMixin'),j=b('MercuryAudioPlayer'),k=b('Env'),l=b('JSLogger'),m=b('LeftRight.react'),n=b('React'),o=b('cx'),p=b('shield'),q=b('tx'),r='MercuryAttachmentAudioClip/play',s=l.create('mercury_audio_clip'),t=n.createClass({displayName:'AudioClip',mixins:[i],getInitialState:function(){this.subscribe('playing',this.updateTime.bind(this));this.subscribe('played',p(this.setState,this,{playing:true,started:true}));this.subscribe('paused',p(this.setState,this,{playing:false}));this.subscribe('finished',p(this.setState,this,{playing:false,started:false,time:this.props.duration}));this.logged=false;var u=this.props.downloadOnly?false:new j(this.props.src,this);h.subscribe(r,function(v,w){if(this.props.src!=w)this.setState({time:0});}.bind(this));return {time:0,playing:false,started:false,duration:this.props.duration,audioPlayer:u};},updateTime:function(u,v){this.setState({time:v});},play:function(){if(this.state.playing){this.state.audioPlayer.pause();}else{this.state.audioPlayer.play(this.state.started);h.inform(r,this.props.src);if(!this.logged){this.logged=true;s.log('play',{uid:k.user,duration:this.props.duration});}}},_formatSeconds:function(u){if(u){u=Math.ceil(u);var v=u%60;if(v<10)v='0'+v;var w=Math.floor(u/60);return w+':'+v;}else return null;},_renderPlayer:function(u,v){return (g.a({className:"_1miz",style:{width:u},onClick:this.play.bind(this)},[g.span({className:"_1mi-"},g.i({className:"_1mi_"},null)),g.span({className:"_1mj0"},v),g.div({className:"_1mj1"},null)]));},render:function(){var u=this.state.time,v=this.state.playing,w=this._formatSeconds(this.state.duration),x=this.props.width||170,y=null,z=Math.ceil((u*(x+2))/this.state.duration);if(this.state.audioPlayer&&this.state.audioPlayer.getType()){var aa=this._renderPlayer(x,w),ba=this._renderPlayer(x,w),ca=(("_1mj2")+(v&&(u!==0)?' '+"_1mj3":'')+(v&&(u===0)?' '+"_4g4x":''));y=(g.div({className:ca},[aa,g.div({className:"_1mj4",style:{width:z}},ba)]));}else y=(g.div({className:"_1mj2"},g.div({className:"_1miz"},m(null,[g.a({className:"_1mj5",href:this.props.src},[g.span({className:"_3qi6"},g.i({className:"_1mj6"},null)),g.span({className:"_1mj7"},"Voice Message"),g.span({className:"_1mj8"},w)]),g.a({href:this.props.src,className:"_1mj9"},g.i({className:"_1mja"},null))]))));return (g.div({className:"_1mjb"},y));}});e.exports=t;});
__d("md5",[],function(a,b,c,d,e,f){function g(u,v){var w=u[0],x=u[1],y=u[2],z=u[3];w=i(w,x,y,z,v[0],7,-680876936);z=i(z,w,x,y,v[1],12,-389564586);y=i(y,z,w,x,v[2],17,606105819);x=i(x,y,z,w,v[3],22,-1044525330);w=i(w,x,y,z,v[4],7,-176418897);z=i(z,w,x,y,v[5],12,1200080426);y=i(y,z,w,x,v[6],17,-1473231341);x=i(x,y,z,w,v[7],22,-45705983);w=i(w,x,y,z,v[8],7,1770035416);z=i(z,w,x,y,v[9],12,-1958414417);y=i(y,z,w,x,v[10],17,-42063);x=i(x,y,z,w,v[11],22,-1990404162);w=i(w,x,y,z,v[12],7,1804603682);z=i(z,w,x,y,v[13],12,-40341101);y=i(y,z,w,x,v[14],17,-1502002290);x=i(x,y,z,w,v[15],22,1236535329);w=j(w,x,y,z,v[1],5,-165796510);z=j(z,w,x,y,v[6],9,-1069501632);y=j(y,z,w,x,v[11],14,643717713);x=j(x,y,z,w,v[0],20,-373897302);w=j(w,x,y,z,v[5],5,-701558691);z=j(z,w,x,y,v[10],9,38016083);y=j(y,z,w,x,v[15],14,-660478335);x=j(x,y,z,w,v[4],20,-405537848);w=j(w,x,y,z,v[9],5,568446438);z=j(z,w,x,y,v[14],9,-1019803690);y=j(y,z,w,x,v[3],14,-187363961);x=j(x,y,z,w,v[8],20,1163531501);w=j(w,x,y,z,v[13],5,-1444681467);z=j(z,w,x,y,v[2],9,-51403784);y=j(y,z,w,x,v[7],14,1735328473);x=j(x,y,z,w,v[12],20,-1926607734);w=k(w,x,y,z,v[5],4,-378558);z=k(z,w,x,y,v[8],11,-2022574463);y=k(y,z,w,x,v[11],16,1839030562);x=k(x,y,z,w,v[14],23,-35309556);w=k(w,x,y,z,v[1],4,-1530992060);z=k(z,w,x,y,v[4],11,1272893353);y=k(y,z,w,x,v[7],16,-155497632);x=k(x,y,z,w,v[10],23,-1094730640);w=k(w,x,y,z,v[13],4,681279174);z=k(z,w,x,y,v[0],11,-358537222);y=k(y,z,w,x,v[3],16,-722521979);x=k(x,y,z,w,v[6],23,76029189);w=k(w,x,y,z,v[9],4,-640364487);z=k(z,w,x,y,v[12],11,-421815835);y=k(y,z,w,x,v[15],16,530742520);x=k(x,y,z,w,v[2],23,-995338651);w=l(w,x,y,z,v[0],6,-198630844);z=l(z,w,x,y,v[7],10,1126891415);y=l(y,z,w,x,v[14],15,-1416354905);x=l(x,y,z,w,v[5],21,-57434055);w=l(w,x,y,z,v[12],6,1700485571);z=l(z,w,x,y,v[3],10,-1894986606);y=l(y,z,w,x,v[10],15,-1051523);x=l(x,y,z,w,v[1],21,-2054922799);w=l(w,x,y,z,v[8],6,1873313359);z=l(z,w,x,y,v[15],10,-30611744);y=l(y,z,w,x,v[6],15,-1560198380);x=l(x,y,z,w,v[13],21,1309151649);w=l(w,x,y,z,v[4],6,-145523070);z=l(z,w,x,y,v[11],10,-1120210379);y=l(y,z,w,x,v[2],15,718787259);x=l(x,y,z,w,v[9],21,-343485551);u[0]=r(w,u[0]);u[1]=r(x,u[1]);u[2]=r(y,u[2]);u[3]=r(z,u[3]);}function h(u,v,w,x,y,z){v=r(r(v,u),r(x,z));return r((v<<y)|(v>>>(32-y)),w);}function i(u,v,w,x,y,z,aa){return h((v&w)|((~v)&x),u,v,y,z,aa);}function j(u,v,w,x,y,z,aa){return h((v&x)|(w&(~x)),u,v,y,z,aa);}function k(u,v,w,x,y,z,aa){return h(v^w^x,u,v,y,z,aa);}function l(u,v,w,x,y,z,aa){return h(w^(v|(~x)),u,v,y,z,aa);}function m(u){var v=u.length,w=[1732584193,-271733879,-1732584194,271733878],x;for(x=64;x<=u.length;x+=64)g(w,n(u.substring(x-64,x)));u=u.substring(x-64);var y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(x=0;x<u.length;x++)y[x>>2]|=u.charCodeAt(x)<<((x&3)<<3);y[x>>2]|=128<<((x&3)<<3);if(x>55){g(w,y);for(x=0;x<16;x++)y[x]=0;}y[14]=v*8;g(w,y);return w;}function n(u){var v=[],w=0;while(w<64)v[w>>2]=u.charCodeAt(w++)|(u.charCodeAt(w++)<<8)|(u.charCodeAt(w++)<<16)|(u.charCodeAt(w++)<<24);return v;}var o='0123456789abcdef'.split('');function p(u){var v='',w=0;for(;w<4;w++)v+=o[(u>>((w<<3)+4))&15]+o[(u>>(w<<3))&15];return v;}function q(u){for(var v=0;v<u.length;v++)u[v]=p(u[v]);return u.join('');}var r=function(u,v){return (u+v)&4294967295;};function s(u){var v="",w,x;for(var y=0;y<u.length;y++){w=u.charCodeAt(y);x=y+1<u.length?u.charCodeAt(y+1):0;if(55296<=w&&w<=56319&&56320<=x&&x<=57343){w=65536+((w&1023)<<10)+(x&1023);y++;}if(w<=127){v+=String.fromCharCode(w);}else if(w<=2047){v+=String.fromCharCode(192|((w>>>6)&31),128|(w&63));}else if(w<=65535){v+=String.fromCharCode(224|((w>>>12)&15),128|((w>>>6)&63),128|(w&63));}else if(w<=2097151)v+=String.fromCharCode(240|((w>>>18)&7),128|((w>>>12)&63),128|((w>>>6)&63),128|(w&63));}return v;}function t(u){if(null===u||undefined===u){return null;}else{for(var v=0;v<u.length;v++)if(u[v]>"\u007F"){u=s(u);break;}return q(m(u));}}if(t('hello')!='5d41402abc4b2a76b9719d911017c592')r=function(u,v){var w=(u&65535)+(v&65535),x=(u>>16)+(v>>16)+(w>>16);return (x<<16)|(w&65535);};e.exports=t;});
__d("isRTL",[],function(a,b,c,d,e,f){var g='A-Za-z\xC0-\xD6\xD8-\xF6\xF8-\u02B8\u0300-\u0590\u0800-\u1FFF'+'\u200E\u2C00-\uFB1C\uFE00-\uFE6F\uFEFD-\uFFFF',h='\u0591-\u07FF\u200F\uFB1D-\uFDFF\uFE70-\uFEFC',i=new RegExp('^[^'+g+']*['+h+']'),j=new RegExp('['+g+']');function k(l){var m=0,n=0;l.split(/\s+/,20).forEach(function(o){if(/^https?:\/\//.test(o))return;if(i.test(o)){n++;m++;}else if(j.test(o))m++;});return !!(m&&(n/m>.4));}e.exports=k;});
__d("WaterfallIDGenerator",["Env","md5"],function(a,b,c,d,e,f){var g=b('Env'),h=b('md5');function i(){var l=2147483647;return Math.random()*l;}function j(){return Math.floor(Date.now()/1000);}var k={generate:function(){return h([g.user,j(),i()].join(':'));}};e.exports=k;});
__d("FeatureDetection",["UserAgent"],function(a,b,c,d,e,f){var g=b('UserAgent');e.exports={isFileAPISupported:function(){if(g.webkit()&&!g.chrome()&&g.windows())return false;return ('FileList' in window)&&('FormData' in window);},isBlobFactorySupported:function(){return !!a.Blob;}};});
__d("AsyncUploadBase",["ArbiterMixin","AsyncRequest","AsyncResponse","Form","FeatureDetection","copyProperties","removeFromArray"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('AsyncRequest'),i=b('AsyncResponse'),j=b('Form'),k=b('FeatureDetection'),l=b('copyProperties'),m=b('removeFromArray');function n(p){this.setURI(p);}n.isSupported=function(){return k.isFileAPISupported();};l(n.prototype,g,{_limit:10,setAllowCrossOrigin:function(p){this._allowCrossOrigin=!!p;return this;},setData:function(p){this._data=p;return this;},setLimit:function(p){this._limit=p;return this;},setRelativeTo:function(p){this._relativeTo=p;return this;},setStatusElement:function(p){this._statusElement=p;return this;},setURI:function(p){this._uri=p;return this;},suspend:function(){this._suspended=true;return this;},resume:function(){this._suspended=false;this._processQueue();return this;},isUploading:function(){return this._inFlight;},_createFileUpload:function(p,q,r){return new o(p,q,r);},_parseFiles:function(p){var q={};for(var r in p){var s=p[r];if(Array.isArray(s)){q[r]=s;}else{q[r]=[];if(s instanceof window.FileList){for(var t=0;t<s.length;t++)q[r].push(s.item(t));}else if(s instanceof window.File||s instanceof window.Blob)q[r].push(s);}}return q;},_processQueue:function(){if(this._suspended)return;while(this._pending.length<this._limit){if(!this._waiting.length)break;var p=this._waiting.shift();this._processUpload(p);this._pending.push(p);}},_processUpload:function(p){var q=j.createFormData(p.getData()||this._data);if(p.getFile()){q.append(p.getName(),p.getFile());q.append('upload_id',p.getFile().uploadID);}var r=new h().setAllowCrossOrigin(this._allowCrossOrigin).setURI(this._uri).setRawData(q).setRelativeTo(this._relativeTo).setStatusElement(this._statusElement).setHandler(this._success.bind(this,p)).setErrorHandler(this._failure.bind(this,p)).setUploadProgressHandler(this._progress.bind(this,p)).setInitialHandler(this._initial.bind(this,p));r.send();p.setAsyncRequest(r);this._inFlight=true;this.inform('start',p);},_abort:function(p){m(this._waiting,p);p.abort();},_initial:function(p){this.inform('initial',p);},_success:function(p,q){this._complete(p);this.inform('success',p.handleSuccess(q));this._processQueue();},_failure:function(p,q){this._complete(p);if(this.inform('failure',p.handleFailure(q))!==false)i.defaultErrorHandler(q);this._processQueue();},_progress:function(p,event){this.inform('progress',p.handleProgress(event));},_complete:function(p){m(this._pending,p);if(!this._pending.length)this._inFlight=false;}});var o=function(p,q,r){this._name=p;this._file=q;this._data=r;this._success=null;this._response=null;this._progressEvent=null;this._request=null;};l(o.prototype,{getName:function(){return this._name;},getFile:function(){return this._file;},getData:function(){return this._data;},isComplete:function(){return this._success!==null;},isSuccess:function(){return this._success===true;},getResponse:function(){return this._response;},getProgressEvent:function(){return this._progressEvent;},setAsyncRequest:function(p){this._request=p;return this;},isWaiting:function(){return !this._request;},abort:function(){this._request&&this._request.abort();this._request=null;},handleSuccess:function(p){this._success=true;this._response=p;this._progressEvent=null;return this;},handleFailure:function(p){this._success=false;this._response=p;this._progressEvent=null;return this;},handleProgress:function(event){this._progressEvent=event;return this;}});e.exports=n;});
__d("AsyncUploadRequest",["AsyncUploadBase","Class","copyProperties"],function(a,b,c,d,e,f){var g=b('AsyncUploadBase'),h=b('Class'),i=b('copyProperties');function j(k){this.parent.construct(this,k);}j.isSupported=function(){return g.isSupported();};h.extend(j,g);i(j.prototype,{setFiles:function(k){this._files=this._parseFiles(k);return this;},send:function(){if(this._inFlight)return;this._inFlight=true;this._uploads=[];for(var k in this._files)this._files[k].forEach(function(l){this._uploads.push(this._createFileUpload(k,l));}.bind(this));if(this._uploads.length){this._waiting=this._uploads.slice(0);this._pending=[];this._processQueue();}else this._processUpload(this._createFileUpload(null,null));},_processQueue:function(){this.parent._processQueue();if(!this._pending.length&&!this._waiting.length)this.inform('complete',this._uploads);}});e.exports=j;});
__d("FileForm",["ArbiterMixin","AsyncRequest","AsyncResponse","AsyncUploadRequest","BehaviorsMixin","DataStore","DOMQuery","Env","Event","Form","JSONPTransport","Parent","URI","copyProperties","shield"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('AsyncRequest'),i=b('AsyncResponse'),j=b('AsyncUploadRequest'),k=b('BehaviorsMixin'),l=b('DataStore'),m=b('DOMQuery'),n=b('Env'),o=b('Event'),p=b('Form'),q=b('JSONPTransport'),r=b('Parent'),s=b('URI'),t=b('copyProperties'),u=b('shield');function v(y){var z={},aa=m.scry(y,'input[type="file"]');aa.forEach(function(ba){z[ba.name]=ba.files;});return z;}function w(y){var z=m.scry(y,'input[type="file"]');z.forEach(function(aa){aa.files=null;});}function x(y,z,aa){if(y.getAttribute('rel')==='async')throw new Error('FileForm cannot be used with Primer forms.');if(y.getAttribute('method').toUpperCase()!=='POST')throw new Error('FileForm must be used with POST forms.');this._form=y;this._previousEncoding=this._form.enctype;this._form.enctype=this._form.encoding='multipart/form-data';z&&this.enableBehaviors(z);this._options=aa||{};this.setAllowCrossOrigin(this._options.allowCrossOrigin);this.setUploadInParallel(this._options.uploadInParallel);this._listener=o.listen(this._form,'submit',this._submit.bind(this));l.set(this._form,'FileForm',this);}t(x,{EVENTS:['start','submit','initial','progress','success','failure'],getInstance:function(y){return l.get(y,'FileForm');}});t(x.prototype,g,k,{getRoot:function(){return this._form;},setAllowCrossOrigin:function(y){this._allowCrossOrigin=!!y;return this;},setUploadInParallel:function(y){this._uploadInParallel=!!y;return this;},_submit:function(event){if(this.inform('submit')===false){event.prevent();return;}var y='FormData' in window;if(y)if(!s(this._form.action).isSameOrigin()&&!this._allowCrossOrigin)y=false;return y?this._sendViaXHR(event):this._sendViaFrame(event);},_sendViaFrame:function(event){var y=this._request=new h();y.setStatusElement(this._getStatusElement());y.addStatusIndicator();y.setOption('useIframeTransport',true);var z=y.handleResponse.bind(y),aa=new q('iframe',this._form.action,z),ba=aa.getTransportFrame(),ca=aa.getRequestURI().addQueryData({__iframe:true,__user:n.user});this._form.setAttribute('action',ca.toString());this._form.setAttribute('target',ba.name);y.setJSONPTransport(aa);y.setURI(ca);y.setHandler(this.success.bind(this,null));y.setErrorHandler(this.failure.bind(this,null));y.setInitialHandler(u(this.initial,this,null));},_sendViaXHR:function(event){var y;if(this._uploadInParallel&&j.isSupported()){y=new j().setData(p.serialize(this._form)).setFiles(v(this._form));var z=[y.subscribe('progress',function(aa,ba){this.progress(ba,ba.getProgressEvent());}.bind(this)),y.subscribe('initial',function(aa,ba){this.initial(ba,ba.getResponse());}.bind(this)),y.subscribe('success',function(aa,ba){this.success(ba,ba.getResponse());}.bind(this)),y.subscribe('start',function(aa,ba){this.inform('start',{upload:ba});}.bind(this)),y.subscribe('failure',function(aa,ba){this.failure(ba,ba.getResponse());return false;}.bind(this)),y.subscribe('complete',function(){while(z.length)z.pop().unsubscribe();})];}else y=new h().setRawData(p.createFormData(this._form)).setHandler(this.success.bind(this,null)).setErrorHandler(this.failure.bind(this,null)).setUploadProgressHandler(this.progress.bind(this,null)).setInitialHandler(u(this.initial,this,null));y.setAllowCrossOrigin(this._allowCrossOrigin).setRelativeTo(this._form).setStatusElement(this._getStatusElement()).setURI(this._form.action).send();this._request=y;event.prevent();},initial:function(y){return this.inform('initial',{upload:y});},success:function(y,z){var aa={response:z,upload:y};if(this.inform('success',aa)!==false)o.fire(this._form,'success',aa);this._cleanup();},failure:function(y,z){var aa={response:z,upload:y};if(this.inform('failure',aa)!==false)if(o.fire(this._form,'error',aa)!==false)i.defaultErrorHandler(z);this._cleanup();},progress:function(y,event){this.inform('progress',{event:event,upload:y});},abort:function(){if(this._request){this._request.abort();this._cleanup();}},clear:function(){w(this._form);},destroy:function(){this._cleanup();this._listener.remove();this._listener=null;this._form.enctype=this._form.encoding=this._previousEncoding;l.remove(this._form,'FileForm');},_cleanup:function(){this._request=null;},_getStatusElement:function(){return r.byClass(this._form,'stat_elem')||this._form;}});e.exports=x;});
__d("FileFormResetOnSubmit",["DOMQuery","copyProperties"],function(a,b,c,d,e,f){var g=b('DOMQuery'),h=b('copyProperties');function i(j){this._form=j;}h(i.prototype,{enable:function(){this._subscription=this._form.subscribe('submit',Function.prototype.defer.bind(this._reset.bind(this)));},disable:function(){this._subscription.unsubscribe();this._subscription=null;},_reset:function(){var j=g.scry(this._form.getRoot(),'input[type="file"]');j.forEach(function(k){k.value='';});}});e.exports=i;});
__d("submitForm",["DOM"],function(a,b,c,d,e,f){var g=b('DOM'),h=function(i){var j=g.scry(i,'input[type="submit"]')[0];if(j){j.click();}else{j=g.create('input',{type:'submit',className:'hidden_elem'});g.appendContent(i,j);j.click();g.remove(j);}};e.exports=h;});
__d("FormSubmitOnChange",["Event","copyProperties","submitForm"],function(a,b,c,d,e,f){var g=b('Event'),h=b('copyProperties'),i=b('submitForm');function j(k){this._form=k;}h(j.prototype,{_listener:null,enable:function(){this._listener=g.listen(this._form.getRoot(),'change',this._submit.bind(this));},disable:function(){this._listener.remove();this._listener=null;},_submit:function(){i(this._form.getRoot());}});e.exports=j;});
__d("MercuryFileUploader",["ArbiterMixin","CSS","Dialog","DOM","Event","FileForm","FileFormResetOnSubmit","FileInput","FormSubmitOnChange","MercuryAttachment","MercuryAttachmentTemplates","MercuryConstants","SubscriptionsHandler","copyProperties","csx","getObjectValues","shield","startsWith","tx"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('CSS'),i=b('Dialog'),j=b('DOM'),k=b('Event'),l=b('FileForm'),m=b('FileFormResetOnSubmit'),n=b('FileInput'),o=b('FormSubmitOnChange'),p=b('MercuryAttachment'),q=b('MercuryAttachmentTemplates'),r=b('MercuryConstants'),s=b('SubscriptionsHandler'),t=b('copyProperties'),u=b('csx'),v=b('getObjectValues'),w=b('shield'),x=b('startsWith'),y=b('tx'),z=0;function aa(ca,da,ea,fa){this._parentElem=ca;this._attachments={};this._uploading={};this._uploadTemplates={};this._uploadStartTimes={};this._subscriptionsHandler=new s();this._fileForm=new l(da,[o,m]);this._fileForm.setAllowCrossOrigin(true);this._fileForm.setUploadInParallel(true);var ga=j.find(da,"._4q60"),ha=j.find(ga,"._4q61");new n(ga,ha,ea);h.hide(this._parentElem);this._subscriptionsHandler.addSubscriptions(this._fileForm.subscribe('submit',function(){var ia='upload_'+z++;fa.value=ia;var ja={count:0,file_sizes:[]};if(ea.files){for(var ka=0;ka<ea.files.length;ka++)if(ea.files[ka].size>r.AttachmentMaxSize){this._fileForm.abort();this._fileForm.clear();new i().setTitle("The file you have selected is too large").setBody("The file you have selected is too large. The maximum size is 25MB.").setButtons(i.OK).setSemiModal(true).show();return false;}for(var la=0;la<ea.files.length;la++){this._addFileUploadRow(ia,ea.files[la].name);ja.count++;ja.file_sizes.push(ea.files[la].size);}}else{this._addFileUploadRow(ia,ea.value);ja.count=1;}this.inform('submit',ja);}.bind(this)),this._fileForm.subscribe('success',this._onFileUploadSuccess.bind(this)),this._fileForm.subscribe('failure',this._onFileUploadFailure.bind(this)),k.listen(ha,'click',w(this.inform,this,'open')));}t(aa.prototype,g,{isUploading:function(){return !!Object.keys(this._uploading).length;},getAttachments:function(){return v(this._attachments);},removeAttachments:function(){v(this._uploadTemplates).forEach(function(ca){if(ca)j.remove(ca.getRoot());});this._attachments={};this._uploadTemplates={};this._uploading={};this._uploadStartTimes={};h.hide(this._parentElem);this.inform('dom-updated');},destroy:function(){this._subscriptionsHandler.release();this._fileForm.destroy();this.removeAttachments();},_addFileUploadRow:function(ca,da){var ea=q[':fb:mercury:upload-file-row'].build(),fa=ba(da),ga=ca+'/'+fa;this._uploadTemplates[ga]=ea;this._uploading[ga]=true;this._uploadStartTimes[ga]=Date.now();j.appendContent(ea.getNode('iconText'),fa);k.listen(ea.getNode('closeFileUpload'),'click',this._removeFileUploader.bind(this,ga));j.appendContent(this._parentElem,ea.getRoot());h.show(this._parentElem);this.inform('dom-updated');},_removeFileUploader:function(ca,event){if(this._uploading[ca]){this.inform('upload-canceled-during-upload');}else if(this._attachments[ca])this.inform('upload-canceled-after-uploaded');delete this._attachments[ca];delete this._uploading[ca];delete this._uploadStartTimes[ca];var da=this._uploadTemplates[ca];delete this._uploadTemplates[ca];if(da){j.remove(da.getRoot());this.inform('dom-updated');}this.inform('upload-canceled');return false;},_updateFileUploader:function(ca,da){var ea=this._uploadTemplates[ca],fa=p.getAttachIconClassByMime(da.filetype);h.addClass(ea.getNode('iconText'),fa);h.addClass(ea.getRoot(),'done');},_onFileUploadSuccess:function(event,ca){var da=ca.response.getPayload(),ea=da.uploadID,fa=da.metadata;for(var ga=0;ga<fa.length;ga++){var ha=ea+'/'+fa[ga].filename;if(this._uploading[ha]){delete this._uploading[ha];this._attachments[ha]=fa[ga];this._updateFileUploader(ha,fa[ga]);this.inform('one-upload-completed',{upload_time_ms:Date.now()-this._uploadStartTimes[ha]});}}if(!this.isUploading())this.inform('all-uploads-completed',{count:this.getAttachments().length});},_onFileUploadFailure:function(event,ca){this.inform('one-upload-failed');}});function ba(ca){if(ca&&x(ca,'C:\\fakepath\\'))return ca.substring(12);return ca;}e.exports=aa;});
__d("JoinableConversationMessageFilter",["MercuryLogMessageType","MercuryThreads","MercuryParticipants"],function(a,b,c,d,e,f){var g=b('MercuryLogMessageType'),h=b('MercuryThreads').get(),i=b('MercuryParticipants'),j={_isFilterable:function(k){var l=k.log_message_type;if(!l)return false;if(l==g.JOINABLE_JOINED)return k.log_message_data.joined_participant!==i.user;if(l==g.UNSUBSCRIBE){var m=h.getThreadMetaNow(k.thread_id);if(m&&m.is_joinable)return k.author!==i.user;return false;}return false;},filterMessages:function(k,l,m){var n=[];for(var o=0;o<l.length;o++){var p=l[o];if(j._isFilterable(p)){if(m)k(p);}else n.push(p);}return n;}};e.exports=j;});
__d("MercuryThreadMuter",["AsyncDialog","AsyncRequest","Env","MercuryThreads"],function(a,b,c,d,e,f){var g=b('AsyncDialog'),h=b('AsyncRequest'),i=b('Env'),j=b('MercuryThreads').get(),k={getUserIDEmail:function(){return i.user+'@facebook.com';},getThreadMuteSettingForUser:function(l){return l.mute_settings&&l.mute_settings[k.getUserIDEmail()];},isThreadMuted:function(l){return k.getThreadMuteSettingForUser(l)!==undefined;},showMuteChangeDialog:function(l,m){g.send(new h('/ajax/mercury/mute_thread_dialog.php').setData({muting:l}),function(n){n.subscribe('confirm',function(){this.hide();j.updateThreadMuteSetting(m,l);}.bind(n));});}};e.exports=k;});
__d("WebMessengerEvents",["Arbiter","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('copyProperties'),i=h(new g(),{MASTER_DOM_CHANGED:'master-dom-changed',DETAIL_DOM_CHANGED:'detail-dom-changed',FOCUS_COMPOSER:'focus-composer',FOCUS_SEARCH:'focus-search',FOCUS_AND_SELECT_SEARCH:'focus-and-select-search',SUBMIT_REPLY:'submit-reply',UPDATE_SELECTION:'update-selection',masterDOMChanged:function(){this.inform(i.MASTER_DOM_CHANGED);},detailDOMChanged:function(){this.inform(i.DETAIL_DOM_CHANGED);},focusComposer:function(){this.inform(i.FOCUS_COMPOSER);},focusSearch:function(){this.inform(i.FOCUS_SEARCH);},focusAndSelectSearch:function(){this.inform(i.FOCUS_AND_SELECT_SEARCH);},updateSelection:function(j){this.inform(i.UPDATE_SELECTION,j);},submitReply:function(){this.inform(i.SUBMIT_REPLY);}});e.exports=i;});
__d("WebMessengerSubscriptionsHandler",["SubscriptionsHandler"],function(a,b,c,d,e,f){var g=b('SubscriptionsHandler'),h=new g('webmessenger');e.exports=h;});
__d("isWebMessengerURI",[],function(a,b,c,d,e,f){function g(h){return (/^(\/messages)/).test(h.getPath());}e.exports=g;});
__d("WebMessengerWidthControl",["Arbiter","CSS","CSSClassTransition","DOMDimensions","Event","Style","URI","ViewportBounds","WebMessengerEvents","shield","WebMessengerSubscriptionsHandler","$","cx","isWebMessengerURI","requestAnimationFrame","throttle"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('CSSClassTransition'),j=b('DOMDimensions'),k=b('Event'),l=b('Style'),m=b('URI'),n=b('ViewportBounds'),o=b('WebMessengerEvents'),p=b('shield'),q=b('WebMessengerSubscriptionsHandler'),r=b('$'),s=b('cx'),t=b('isWebMessengerURI'),u=b('requestAnimationFrame'),v=b('throttle'),w=205,x=981,y=257,z=18,aa=848,ba=724,ca=.57,da=56,ea,fa,ga;function ha(ma,na,oa){this.masterChanged=ma;this.detailChaned=na;q.addSubscriptions(k.listen(window,'resize',v(p(ia,this,this),100)),g.subscribe(['sidebar/initialized','sidebar/show','sidebar/hide'],p(ia,this,this),g.SUBSCRIBE_NEW));var pa=la()?da:0;if(oa)pa=w;this._width=la()?0:aa;ga=true;ia(this,pa);}function ia(ma,na){var oa=n.getRight()+n.getLeft();oa=oa||na||0;var pa=j.getViewportWithoutScrollbarDimensions().width-oa,qa=Math.round(Math.max(0,pa/2-x/2));pa=x+qa-y;pa-=z;pa=Math.max(ba,Math.min(aa,pa));if(!isNaN(pa)&&ma._width!==pa){ma._width=pa;var ra=Math.round(pa/(1+ca)),sa=pa-ra;ma.masterChanged(sa);ma.detailChaned(ra);if(la()){var ta=pa+y;ja(function(){if(fa){document.body.className=fa;fa='';}ka(ta+'px');h.removeClass(document.body,"_5262");ga&&o.detailDOMChanged();ga=false;},fa);}}}function ja(ma,na){na&&h.addClass(document.documentElement,"_5261");u(ma);na&&h.removeClass.curry(document.documentElement,"_5261").defer(1000,false);}function ka(ma){l.set(r('pageHead'),'width',ma);l.set(r('globalContainer'),'width',ma);}function la(){if(!ea)ea=h.hasClass(document.body,"_6nw");return ea;}i.registerHandler(function(ma,na,oa,pa){function qa(ra){return la()&&t(m(ra));}if(qa(pa)){fa=na;return true;}else if(qa(oa)){ja(function(){ma.className=na;ka('');},true);return true;}});e.exports=ha;});
__d("TextInputControl",["Event","function-extensions","Class","DOMControl","Input","copyProperties","debounce"],function(a,b,c,d,e,f){var g=b('Event');b('function-extensions');var h=b('Class'),i=b('DOMControl'),j=b('Input'),k=b('copyProperties'),l=b('debounce');function m(n){this.parent.construct(this,n);var o=this.getRoot(),p=l(this.update.bind(this),0);g.listen(o,{input:p,keydown:p,paste:p});}h.extend(m,i);k(m.prototype,{setMaxLength:function(n){j.setMaxLength(this.getRoot(),n);return this;},getValue:function(){return j.getValue(this.getRoot());},isEmpty:function(){return j.isEmpty(this.getRoot());},setValue:function(n){j.setValue(this.getRoot(),n);this.update();return this;},clear:function(){return this.setValue('');},setPlaceholderText:function(n){j.setPlaceholder(this.getRoot(),n);return this;}});e.exports=m;});
__d("TextMetrics",["Event","DOM","Style","UserAgent","debounce"],function(a,b,c,d,e,f){var g=b('Event'),h=b('DOM'),i=b('Style'),j=b('UserAgent'),k=b('debounce'),l;function m(){if(typeof l==='undefined'){var o=h.create('div',{className:'webkitZoomTest'}),p=function(){h.appendContent(document.body,o);l=100/o.clientHeight;h.remove(o);};g.listen(window,'resize',k(p,100));p();}return l;}function n(o,p){this._node=o;this._flexible=!!p;var q='textarea',r='textMetrics';if(this._flexible){q='div';r+=' textMetricsInline';}this._shadow=h.create(q,{className:r});var s=['fontSize','fontStyle','fontWeight','fontFamily','wordWrap'];s.forEach(function(u){i.set(this._shadow,u,i.get(o,u));}.bind(this));var t=i.get(o,'lineHeight');if(j.chrome()||j.webkit())t=Math.round(parseInt(t,10)*m())+'px';i.set(this._shadow,'lineHeight',t);document.body.appendChild(this._shadow);}n.prototype.measure=function(o){var p=this._node,q=this._shadow;o=(o||p.value)+'...';if(!this._flexible){var r=p.clientWidth-i.getFloat(p,'paddingLeft')-i.getFloat(p,'paddingRight');i.set(q,'width',Math.max(r,0)+'px');}h.setContent(q,o);return {width:q.scrollWidth,height:q.scrollHeight};};n.prototype.destroy=function(){h.remove(this._shadow);};e.exports=n;});
__d("TextAreaControl",["Event","Arbiter","ArbiterMixin","Class","CSS","DOMControl","Style","TextInputControl","TextMetrics","copyProperties"],function(a,b,c,d,e,f){var g=b('Event'),h=b('Arbiter'),i=b('ArbiterMixin'),j=b('Class'),k=b('CSS'),l=b('DOMControl'),m=b('Style'),n=b('TextInputControl'),o=b('TextMetrics'),p=b('copyProperties');function q(s,t){return m.getFloat(s,t)||0;}function r(s){this.autogrow=k.hasClass(s,'uiTextareaAutogrow');this.parent.construct(this,s);this.width=null;g.listen(s,'focus',this._handleFocus.bind(this));}j.extend(r,n);p(r.prototype,i,{setAutogrow:function(s){this.autogrow=s;return this;},onupdate:function(){this.parent.onupdate();if(this.autogrow){var s=this.getRoot();if(!this.metrics)this.metrics=new o(s);if(typeof this.initialHeight==='undefined'){this.isBorderBox=m.get(s,'box-sizing')==='border-box'||m.get(s,'-moz-box-sizing')==='border-box'||m.get(s,'-webkit-box-sizing')==='border-box';this.borderBoxOffset=q(s,'padding-top')+q(s,'padding-bottom')+q(s,'border-top-width')+q(s,'border-bottom-width');this.initialHeight=s.offsetHeight-this.borderBoxOffset;}var t=this.metrics.measure(),u=Math.max(this.initialHeight,t.height);if(this.isBorderBox)u+=this.borderBoxOffset;if(u!==this.height){this.height=u;m.set(s,'height',u+'px');h.inform('reflow');this.inform('resize');}}else if(this.metrics){this.metrics.destroy();this.metrics=null;}},resetHeight:function(){this.height=-1;this.update();},_handleFocus:function(){this.width=null;}});r.getInstance=function(s){return l.getInstance(s)||new r(s);};e.exports=r;});
__d("MessagesEmoticonView",["Event","function-extensions","DOM","InputSelection","Parent","TextAreaControl","Toggler","Focus","Keys","copyProperties","endsWith","startsWith","EmoticonsList"],function(a,b,c,d,e,f){var g=b('Event');b('function-extensions');var h=b('DOM'),i=b('InputSelection'),j=b('Parent'),k=b('TextAreaControl'),l=b('Toggler'),m=b('Focus'),n=b('Keys'),o=b('copyProperties'),p=b('endsWith'),q=b('startsWith'),r=b('EmoticonsList'),s=r.symbols;function t(v,w,x){var y=j.byClass(v,'emoticon');if(!y)return;var z='emoticon_',aa=null;y.className.split(' ').forEach(function(ha){if(q(ha,z))aa=ha.substring(z.length);});if(!s[aa])return;var ba=k.getInstance(w),ca=ba.getValue(),da=s[aa],ea=ca.substring(0,x.start),fa=ca.substring(x.end);if(x.start>0&&!p(ea,' '))da=' '+da;if(!q(fa,' '))da+=' ';var ga=ea+da+fa;x.start+=da.length;x.end=x.start;ba.setValue(ga);i.set(w,x.start,x.end);}function u(v,w){var x={start:0,end:0};function y(){x=i.get(w);}var z=h.find(v,'.uiToggleFlyout');this._subscription=l.subscribe('show',function(aa,ba){if(ba.active&&h.contains(v,ba.active)){i.set(w,x.start,x.end);var ca=h.scry(z,'a.emoticon')[0];m.setWithoutOutline(ca);}});this._eventListeners=[g.listen(z,'click',function(event){l.hide(v);t(event.getTarget(),w,x);}),g.listen(z,'keyup',function(event){if(event.keyCode===n.ESC){l.hide(v);i.set(w,x.start,x.end);}}),g.listen(w,'keyup',y),g.listen(w,'click',y)];}o(u.prototype,{destroy:function(){this._subscription.unsubscribe();while(this._eventListeners.length)this._eventListeners.pop().remove();}});o(u,{create:function(v,w){return new u(v,w);}});e.exports=u;});
__d("TypingDetector",["Event","function-extensions","ArbiterMixin","Input","Run","copyProperties","createObjectFrom","emptyFunction"],function(a,b,c,d,e,f){var g=b('Event');b('function-extensions');var h=b('ArbiterMixin'),i=b('Input'),j=b('Run'),k=b('copyProperties'),l=b('createObjectFrom'),m=b('emptyFunction');function n(o){this._input=o;this._ignoreKeys={};}n.INACTIVE=0;n.TYPING=1;n.QUITTING=2;k(n.prototype,h,{_timeout:7000,_currentState:n.INACTIVE,init:function(){this.init=m;this.reset();g.listen(this._input,'keyup',this._update.bind(this));j.onUnload(this._onunload.bind(this));},reset:function(){clearTimeout(this._checkTimer);this._checkTimer=null;this._lastKeystrokeAt=null;this._currentState=n.INACTIVE;},setIgnoreKeys:function(o){this._ignoreKeys=l(o);},_onunload:function(){if(this._currentState==n.TYPING)this._transition(n.QUITTING);},_update:function(event){var o=g.getKeyCode(event),p=this._currentState;if(!this._ignoreKeys[o])if(i.getValue(this._input).trim().length===0){if(p==n.TYPING)this._transition(n.INACTIVE);}else if(p==n.TYPING){this._recordKeystroke();}else if(p==n.INACTIVE){this._transition(n.TYPING);this._recordKeystroke();}},_transition:function(o){this.reset();this._currentState=o;this.inform('change',o);},_recordKeystroke:function(){this._lastKeystrokeTime=Date.now();if(!this._checkTimer)this._checkTimer=this._checkTyping.bind(this).defer(this._timeout);},_checkTyping:function(){var o=this._lastKeystrokeTime+this._timeout,p=Date.now();if(p>o){this._transition(n.INACTIVE);}else{clearTimeout(this._checkTimer);this._checkTimer=this._checkTyping.bind(this).defer(o-p+10);}}});e.exports=n;});
__d("MercuryTypingReceiver",["Arbiter","ChannelConstants","MercuryActionTypeConstants","MercuryParticipants","MercuryPayloadSource","MercuryServerRequests","MercuryThreads","TypingDetector","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ChannelConstants'),i=b('MercuryActionTypeConstants'),j=b('MercuryParticipants'),k=b('MercuryPayloadSource'),l=b('MercuryServerRequests').get(),m=b('MercuryThreads').get(),n=b('TypingDetector'),o=b('setTimeoutAcrossTransitions'),p,q={},r=30000,s=new g();function t(y){var z=q[y]||{},aa=Object.keys(z);aa.sort(function(ba,ca){return z[ba]-z[ca];});return aa;}function u(){p=null;var y=Date.now(),z={},aa=false;for(var ba in q){var ca=false;for(var da in q[ba]||{})if(q[ba][da]<y-r){delete q[ba][da];ca=true;}else aa=true;if(ca)z[ba]=t(ba);}for(var ea in z){s.inform('state-changed',z);break;}if(aa)p=o(u,3000);}function v(y,z){if(y in q)if(z in q[y]){delete q[y][z];w(y);}}function w(y){var z={};z[y]=t(y);s.inform('state-changed',z);}function x(y){if(y.thread)return l.getClientThreadIDNow(y.thread);if(y.type==='typ')return m.getThreadIdForUser(y.from);return null;}g.subscribe([h.getArbiterType('typ'),h.getArbiterType('ttyp')],function(y,z){var aa=z.obj,ba=x(aa);if(ba){var ca=j.getIDForUser(aa.from);if(aa.st==n.TYPING){q[ba]=q[ba]||{};var da=q[ba][ca];q[ba][ca]=Date.now();if(!p)p=o(u,3000);!da&&w(ba);}else if(aa.st==n.INACTIVE)v(ba,ca);}});l.subscribe('update-typing-state',function(y,z){var aa=z.payload_source;if(aa!=k.CLIENT_CHANNEL_MESSAGE)return;var ba=z.actions;if(!ba||!ba.length)return;var ca=i.USER_GENERATED_MESSAGE;ba.forEach(function(da){if(da.action_type==ca&&da.author!=j.user)v(da.thread_id,da.author);});});e.exports=s;});
__d("formatUnixTimestamp",["formatDate"],function(a,b,c,d,e,f){var g=b('formatDate');function h(i,j,k){return g(new Date(i*1000),j,k);}e.exports=h;});
__d("MercuryIndicatorController",["ArbiterMixin","DOM","MercuryActionTypeConstants","MercuryConfig","MercuryDelayedRoger","MercuryMessageSourceTags","MercuryParticipants","MercuryRoger","MercuryThreads","MercuryTypingReceiver","arrayContains","copyProperties","formatUnixTimestamp","removeFromArray","tx"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('DOM'),i=b('MercuryActionTypeConstants'),j=b('MercuryConfig'),k=b('MercuryDelayedRoger'),l=b('MercuryMessageSourceTags'),m=b('MercuryParticipants'),n=b('MercuryRoger'),o=b('MercuryThreads').get(),p=b('MercuryTypingReceiver'),q=b('arrayContains'),r=b('copyProperties'),s=b('formatUnixTimestamp'),t=b('removeFromArray'),u=b('tx'),v=[];function w(x){this._threadID=x;this._canonicalUser=o.getCanonicalUserInThread(x);v.push(this);}r(w.prototype,g,{destroy:function(){t(v,this);},setLastMessage:function(x){this._lastMsg=x;this._handleStateChange();},_informStateChanged:function(x){if(x.activity=='none'&&this._currentActivity=='none')return;if(this._lastMsg&&m.isAuthor(this._lastMsg.author))x.self_authored=true;this._currentActivity=x.activity;this.inform('state-changed',x);},_notifySentFrom:function(){var x,y,z=this._lastMsg.location_text,aa=this._lastMsg.source_tags||[];if(z){x=u._("Sent from {location}",{location:z});y='sentFromMobile';}else if(q(aa,l.MESSENGER)){x=h.create('a',{href:'/mobile/messenger','class':'fcg',target:'_blank'},"Sent from Messenger");y='sentFromMobile';}else if(q(aa,l.MOBILE)){x=h.create('a',{href:'/mobile','class':'fcg',target:'_blank'},"Sent from Mobile");y='sentFromMobile';}else if(q(aa,l.EMAIL)){x="Sent from email";y='sentFromEmail';}else{this._informStateChanged({activity:'none'});return;}this._informStateChanged({activity:y,text:x});},_notifySeenTimestamp:function(x){var y=n.getSeenTimestamp(this._threadID,x[0])*.001,z=Date.now()*.001,aa=j['24h_times']?'H:i':'g:i A';if(y<z-518400){aa='M j';}else if(y<z-86400)aa='D '+aa;var ba=s(y,aa);this._informStateChanged({activity:'seen-timestamp',text:u._("Seen {timestamp}",{timestamp:ba})});},_checkNamesForCollision:function(x,y){var z=false;m.getMulti(x,function(aa){function ba(ea){if(typeof aa[ea]!=="undefined"){return aa[ea].short_name.toLowerCase();}else return ea;}var ca=y.map(ba),da=x.map(ba);z=ca.some(function(ea){return da.indexOf(ea)!==da.lastIndexOf(ea);});});return z;},_notifySeenBy:function(x){var y=this._lastMsg,z=true;m.getMulti(x,function(aa){z=false;if(this._lastMsg!=y)return;var ba=o.getThreadMetaNow(this._threadID),ca=ba?ba.participants.length:0,da=x.length+(y.author!=m.user),ea,fa=false,ga=false,ha=ca>2&&da>=ca-1;if(!(ha)&&ca>0)ga=this._checkNamesForCollision(ba.participants,x);if(ha){ea="Seen by everyone";}else if(x.length==1){ea=u._("Seen by {user}",{user:aa[x[0]].short_name});}else if(x.length==2){ea=u._("Seen by {user1}, {user2}",{user1:aa[x[0]].short_name,user2:aa[x[1]].short_name});}else if(x.length==3){ea=u._("Seen by {user1}, {user2}, {user3}",{user1:aa[x[0]].short_name,user2:aa[x[1]].short_name,user3:aa[x[2]].short_name});}else if(x.length>3){var ia=Object.keys(aa).length-2,ja=u._("{num} more",{num:ia}),ka=h.create('span',{className:'more'},ja);ea=h.tx._("Seen by {user1}, {user2}, {=num more link}",{user1:aa[x[0]].short_name,user2:aa[x[1]].short_name,'=num more link':ka});fa=true;}fa=fa||ga;this._informStateChanged({activity:'seen-by',text:ea,seenBy:x,hasNameCollision:ga,tooltip:fa});}.bind(this));z&&this._informStateChanged({activity:'none'});},_notifyTyping:function(x){var y=this._lastMsg,z=true;m.getMulti(x,function(aa){z=false;if(this._lastMsg!=y)return;if(this._canonicalUser||j.ChatMultiTypGK){var ba=o.getThreadMetaNow(this._threadID),ca=ba?ba.participants.length:0,da,ea=false;if(ca>2&&x.length>=ca-1){da="Everyone is typing...";}else if(x.length==1){da=u._("{name} is typing...",{name:aa[x[0]].short_name});}else if(x.length==2){da=u._("{user1} and {user2} are typing...",{user1:aa[x[0]].short_name,user2:aa[x[1]].short_name});}else if(x.length==3){da=u._("{user1}, {user2}, and {user3} are typing...",{user1:aa[x[0]].short_name,user2:aa[x[1]].short_name,user3:aa[x[2]].short_name});}else if(x.length>3){var fa=Object.keys(aa).length-2,ga=u._("{num} more",{num:fa}),ha=h.create('a',{href:'#'},ga);da=h.tx._("{user1}, {user2}, and {=num more link} are typing...",{user1:aa[x[0]].short_name,user2:aa[x[1]].short_name,'=num more link':ha});ea=true;}this._informStateChanged({activity:'typing',text:da,typing:x,tooltip:ea});}}.bind(this));z&&this._informStateChanged({activity:'none'});},_handleStateChange:function(){var x=i.LOG_MESSAGE;if(!this._lastMsg||this._lastMsg.action_type==x){this._informStateChanged({activity:'none'});return;}if(this._typing&&this._typing.length){this._notifyTyping(this._typing);return;}if(this._canonicalUser&&this._lastMsg.author!=m.user){this._notifySentFrom();return;}var y=k.getSeenBy(this._threadID,true);if(y.length)if(this._canonicalUser){this._notifySeenTimestamp(y);return;}else{this._notifySeenBy(y);return;}this._informStateChanged({activity:'none'});}});p.subscribe('state-changed',function(x,y){v.forEach(function(z){var aa=y[z._threadID];if(aa!==undefined){z._typing=aa;z._handleStateChange();}});});k.subscribe('state-changed',function(x,y){v.forEach(function(z){y[z._threadID]&&z._handleStateChange();});});e.exports=w;});
__d("MercuryLastMessageIndicator",["CSS","MercuryIndicatorController","DOM","MercuryParticipants","Tooltip","copyProperties","csx","cx"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('MercuryIndicatorController'),i=b('DOM'),j=b('MercuryParticipants'),k=b('Tooltip'),l=b('copyProperties'),m=b('csx'),n=b('cx');function o(p,q,r,s){this._lastMessageIndicator=q;this._hideTyping=r||false;this._messagesView=s;this._controller=new h(p);this._subscription=this._controller.subscribe('state-changed',this._handleStateChanged.bind(this));}l(o.prototype,{destroy:function(){this._setClass(null);this._subscription.unsubscribe();this._controller.destroy();},setLastMessage:function(p){this._controller.setLastMessage(p);},_handleStateChanged:function(p,q){var r=this._messagesView.isScrolledToBottom();this._rerender(q);r&&this._messagesView.scrollToBottom();},_rerender:function(p){if(p.activity=='none'){this._setClass(null);return;}if(this._hideTyping&&p.activity=='typing'){this._setClass(null);return;}g.conditionClass(this._lastMessageIndicator,"_510e",p.self_authored);var q=i.find(this._lastMessageIndicator,"._510f");if(p.text){i.setContent(q,p.text);}else i.empty(q);if(p.activity.substring(0,4)=='seen'){this._setClass('seen');if(p.activity=='seen-by'&&p.tooltip){j.getMulti(p.seenBy,function(r){var s=i.create('div');for(var t in r){var u=i.create('div');i.setContent(u,r[t].name);i.appendContent(s,u);}var v=p.hasNameCollision,w;if(v){w=this._lastMessageIndicator;}else w=i.find(this._lastMessageIndicator,'span.more');k.set(w,s,'above','center');}.bind(this));}else k.remove(this._lastMessageIndicator);}else this._setClass(p.activity);},_setClass:function(p){if(this._lastClass===p)return;this._lastClass&&g.removeClass(this._lastMessageIndicator,this._lastClass);p&&g.addClass(this._lastMessageIndicator,p);this._lastClass=p;}});e.exports=o;});
__d("MercuryStateCheck",["Arbiter","ChannelConstants","MercuryFolders","MessagingTag","MercuryServerRequests","URI","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ChannelConstants'),i=b('MercuryFolders'),j=b('MessagingTag'),k=b('MercuryServerRequests').get(),l=b('URI'),m=b('copyProperties'),n=m(new g(),{initialize:function(){g.subscribe(h.ON_INVALID_HISTORY,o);d(['ChannelConnection'],function(p){p.subscribe(p.CONNECTED,function(q,r){if(!r.init)o();});});}});function o(){var p;if(l.getRequestURI().getPath().search(/messages/)!==-1){p=i.getSupportedFolders();}else p=[j.INBOX];k.fetchMissedMessages(p);}n.initialize();e.exports=n;});
__d("MercuryAttachmentRenderer",["JSXDOM","MercuryAttachmentTemplates","MercuryAttachmentAudioClip.react","CSS","MercuryConstants","DOM","MercuryAttachment","MercuryAttachmentType","MercuryMessages","MercuryParticipants","React","Style","URI","UserAgent","cx","tx"],function(a,b,c,d,e,f){var g=b('JSXDOM'),h=b('MercuryAttachmentTemplates'),i=b('MercuryAttachmentAudioClip.react'),j=b('CSS'),k=b('MercuryConstants'),l=b('DOM'),m=b('MercuryAttachment'),n=b('MercuryAttachmentType'),o=b('MercuryMessages').get(),p=b('MercuryParticipants'),q=b('React'),r=b('Style'),s=b('URI'),t=b('UserAgent'),u=b('cx'),v=b('tx'),w=t.ie()<=8;function x(aa,ba){var ca=h[ba].build().setNodeContent('filename',aa.name),da=ca.getNode('link');da.setAttribute('href',aa.url);aa.rel&&da.setAttribute('rel',aa.rel);j.addClass(ca.getRoot(),m.getAttachIconClass(aa.icon_type));return ca;}function y(aa,ba){var ca=h[ba].build().setNodeContent('filename',aa.name);j.addClass(ca.getRoot(),m.getAttachIconClass(aa.icon_type));return ca;}var z={renderAttachment:function(aa,ba,ca,da,ea){var fa=100,ga=aa?160:400,ha=ba.attach_type,ia=null,ja=null,ka=true,la=k.MercurySupportedShareType;if(ha==n.ERROR)ia=z.renderError(ba);if(!aa&&ha==n.SHARE&&ba.share_xhp)ja=z.renderShareXHP(ba,ca.id);if(!ja&&ha==n.SHARE){var ma=ba.share_data_type;switch(ma){case la.FB_PHOTO:ja=z.renderPreview(ba,ca,da,ea);break;case la.FB_VIDEO:ja=z.renderVideoThumb(ba);break;case la.FB_MUSIC_ALBUM:case la.FB_SONG:ja=z.renderMusic(ba);break;case la.EXTERNAL:case la.FB_TEMPLATE:case la.FB_COUPON:case la.FB_SOCIAL_REPORT_PHOTO:ja=z.renderExternalLink(ba);break;case la.FB_STICKER:ka=false;ja=z.renderSticker(ba,ca.id);break;default:if(ba.name)ja=z.renderShareLink(ba,ca&&ca.id,aa);break;}}if(!ja&&ba.preview_loading)ja=z.renderPreview(null);if(!ja&&ba.preview_url)ja=z.renderPreview(ba,ca,da,ea);if(!ja&&ha==n.FILE)if(ba.metadata&&ba.metadata.type==k.MercuryAttachmentAudioClip){ja=l.create('div');var na=z.renderAudioClip(ba,ca.message_id,fa,ga);q.renderComponent(na,ja);}else ja=aa?z.renderFileLink(ba):z.renderExtendedFileLink(ba);return {error:ia,content:ja,bubblePreferred:ka};},renderError:function(aa){var ba=h[':fb:mercury:attachment:error'].build();l.appendContent(ba.getNode('error'),aa.error_msg);return ba.getRoot();},renderExternalLink:function(aa){var ba=h[':fb:mercury:attachment:external-link'].build().setNodeContent('name',aa.name);aa.base_url&&ba.setNodeContent('shortLink',aa.base_url);var ca=ba.getNode('preview'),da=ba.getNode('image-link');da.setAttribute('href',aa.url);aa.rel&&da.setAttribute('rel',aa.rel);if(aa.preview_url){var ea=ba.getNode('preview-image');ea.setAttribute('src',aa.preview_url);j.addClass(ca,aa.preview_class);j.show(ea);}else{j.addClass(ba.getRoot(),'noMedia');j.hide(ca);}ba.getNode('name').setAttribute('href',aa.url);d(['LinkshimHandler'],function(fa){fa.setUpLinkshimHandling(ba.getNode('name'));fa.setUpLinkshimHandling(ba.getNode('image-link'));});if(aa.rel)ba.getNode('name').setAttribute('rel',aa.rel);return ba.getRoot();},renderFileLink:function(aa){var ba=null;if(aa.url===''){ba=':fb:mercury:attachment:file-name';return y(aa,ba).getRoot();}else{ba=':fb:mercury:attachment:file-link';return x(aa,ba).getRoot();}},renderAudioClip:function(aa,ba,ca,da){var ea=aa.metadata.duration/1000,fa=200;if(ca&&da)if(ea<5){fa=ca;}else fa=(1-Math.pow(10,(ea-5)/-30))*(da-ca)+ca;return i({src:aa.url,duration:aa.metadata.duration/1000,showHelp:false,width:fa});},renderExtendedFileLink:function(aa){var ba=null;if(aa.url===''){ba=':fb:mercury:attachment:file-name';return y(aa,ba).getRoot();}var ba=':fb:mercury:attachment:extended-file-link',ca=x(aa,ba);if(aa.open_url){var da=ca.getNode('openLinkContainer');j.show(da);var ea=ca.getNode('openFile');ea.setAttribute('href',aa.open_url);}var fa=ca.getNode('downloadFile');fa.setAttribute('href',aa.url);aa.rel&&fa.setAttribute('rel',aa.rel);return ca.getRoot();},renderMusic:function(aa){var ba=h[':fb:mercury:attachment:music'].build().setNodeContent('filename',aa.name),ca=ba.getNode('link');ca.setAttribute('href',aa.url);ca.setAttribute('target','_blank');aa.rel&&ca.setAttribute('rel',aa.rel);var da=ba.getNode('image-link');da.setAttribute('href',aa.url);aa.rel&&da.setAttribute('rel',aa.rel);var ea=ba.getNode('preview-image');ea.setAttribute('src',aa.preview_url);j.show(ea);j.addClass(ba.getNode('icon_link'),'MercuryMusicIcon');return ba.getRoot();},resizeContain:function(aa,ba){var ca=aa.width/aa.height,da=ba.width/ba.height;if(da<ca){return {width:Math.min(aa.height*da,ba.width),height:Math.min(aa.height,ba.height)};}else return {width:Math.min(aa.width,ba.width),height:Math.min(aa.width/da,ba.height)};},renderPreview:function(aa,ba,ca,da){var ea=h[':fb:mercury:attachment:preview'].build(),fa=ea.getNode('image-link');if(aa){aa.url&&fa.setAttribute('href',aa.url);aa.rel&&fa.setAttribute('rel',aa.rel);var ga;if(aa.preview_uploading){j.addClass(fa,"_57jm");if(ca>=176){ga='/images/photos/dots_large.png';}else if(ca>=86){ga='/images/photos/dots_medium.png';}else ga='/images/photos/dots_small.png';r.set(fa,'width',ca+'px');r.set(fa,'max-width',ca+'px');if(aa.preview_width&&aa.preview_height)r.set(fa,'padding-bottom',((aa.preview_height/aa.preview_width)*100)+'%');}else if(aa.metadata&&aa.metadata.fbid){ga=s('/ajax/mercury/attachments/photo.php').addQueryData({fbid:aa.metadata.fbid,mode:da,width:ca,height:ca}).toString();}else ga=s(aa.preview_url).addQueryData({mode:da,width:ca,height:ca}).toString();var ha=ea.getNode('preview-image');if(ga){if(da==='contain'&&aa.preview_width&&aa.preview_height){var ia=z.resizeContain({width:ca,height:ca},{width:aa.preview_width,height:aa.preview_height});ha.setAttribute('width',ia.width);ha.setAttribute('height',ia.height);}if(aa.preview_uploading||(da==='cover'&&!w)){j.addClass(fa,"_55pj");r.set(fa,'backgroundImage','url('+ga+')');}else{ha.onload=function(){ha.removeAttribute('width');ha.removeAttribute('height');};ha.setAttribute('src',ga);}}if(ba)this.renderReportRespondLink(ea.getRoot(),aa,ba.message_id);}else j.addClass(fa,"_ksa");return ea.getRoot();},renderShareLink:function(aa,ba,ca){var da=h[':fb:mercury:attachment:share-link'].build().setNodeContent('name',aa.name),ea=da.getNode('link');ea.setAttribute('href',aa.url);aa.rel&&ea.setAttribute('rel',aa.rel);return da.getRoot();},renderVideoThumb:function(aa){var ba=h[':fb:mercury:attachment:video-thumb'].build(),ca=ba.getNode('thumb');ca.setAttribute('href',aa.url);ca.setAttribute('rel',aa.rel);var da=l.find(ba.getRoot(),'img');da.src=aa.preview_url;return ba.getRoot();},renderShareXHP:function(aa,ba){var ca=l.create('div');if(aa){l.appendContent(ca,aa.share_xhp);this.renderReportRespondLink(ca,aa,ba);}return ca;},renderSticker:function(aa,ba){var ca=g.div({className:"pvs"},aa.share_xhp.cloneNode(true));this.renderReportRespondLink(ca,aa,ba);return ca;},renderReportRespondLink:function(aa,ba,ca){if(!ba.is_social_report_attachment)return null;switch(ba.share_data_type){case k.MercurySupportedShareType.FB_PHOTO:break;case k.MercurySupportedShareType.FB_SOCIAL_REPORT_PHOTO:return null;default:return null;}var da=null;if(ca)da=o.getMessagesFromIDs([ca])[0];if(!da)return null;if(da.author===p.user)return null;var ea=null;p.get(da.author,function(fa){ea=l.create('a',{rel:'dialog-post',className:"_z6l",id:'respond-link',ajaxify:s('/ajax/report/social_resolution/photo/').setQueryData({attachment_fbid:ba.attach_id,photo_fbid:ba.shared_object_id,sender_id:p.getUserID(fa.id)}).toString()});l.setContent(ea,v._("Respond to {name}'s request",{name:fa.name}));l.appendContent(aa,ea);});},renderPhotoAttachments:function(aa,ba,ca,da){var ea=aa.length;if(!ea)return null;var fa=g.div({className:"_55pk"},null),ga=(g.div({className:"_55pl"},fa));if(ea===1){var ha=z.renderPreview(aa[0],ba,ca,'contain');l.appendContent(fa,ha);return ga;}var ia=(ea==2||ea==4)?2:3,ja=(ca-(ia-1)*da)/ia,ka=Math.ceil(ea/ia),la=ka*ja+(ka-1)*da,ma=(g.div({className:"_55pm",style:'padding-bottom: '+(la/ca*100)+'%;'},null));l.appendContent(fa,ma);for(var na=0;na<ea;++na){var oa=z.renderPreview(aa[na],ba,ja,'cover'),pa=na%ia,qa=Math.floor(na/ia);j.addClass(oa,"_55pn");r.apply(oa,{width:(ja/ca*100)+'%',left:((pa*(ja+da))/ca*100)+'%',top:((qa*(ja+da))/la*100)+'%'});l.appendContent(ma,oa);}return ga;},isPhotoAttachment:function(aa){return aa.attach_type==n.PHOTO||(aa.attach_type==n.FILE&&aa.preview_url);},isShareAttachment:function(aa){return aa.attach_type==n.SHARE;},isFileAttachment:function(aa){return aa.attach_type==n.FILE;},isErrorAttachment:function(aa){return aa.attach_type==n.ERROR;},booleanLexicographicComparator:function(aa){return function(ba,ca){for(var da=0;da<aa.length;++da){var ea=aa[da](ba),fa=aa[da](ca);if(ea&&!fa){return -1;}else if(!ea&&fa)return 1;}return 0;};}};e.exports=z;});
__d("URLScraper",["ArbiterMixin","DataStore","Event","copyProperties"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('DataStore'),i=b('Event'),j=b('copyProperties'),k='scraperLastPermissiveMatch';function l(ma){this.input=ma;this.enable();}j(l.prototype,g,{reset:function(){h.set(this.input,k,null);},enable:function(){if(this.events)return;var ma=function(na){setTimeout(this.check.bind(this,na),30);};this.events=i.listen(this.input,{paste:ma.bind(this,false),keydown:ma.bind(this,true)});},disable:function(){if(!this.events)return;for(var event in this.events)this.events[event].remove();this.events=null;},check:function(ma){var na=this.input.value;if(ma&&l.trigger(na))return;var oa=l.match(na),pa=l.permissiveMatch(na);if(pa&&(pa!=h.get(this.input,k))){h.set(this.input,k,pa);this.inform('match',{url:oa||pa,alt_url:pa});}}});var m='!"#%&\'()*,-./:;<>?@[\\]^_`{|}',n='\u2000-\u206F\u00ab\u00bb\uff08\uff09',o='(?:25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])',p='(?:(?:ht|f)tps?)://',q='(?:(?:'+o+'[.]){3}'+o+')',r='(?:\\b)www\\d{0,3}[.]',s='[^\\s'+m+n+']',t='(?:(?:[.:\\-_%@]|'+s+')*'+s+')',u='(?:[.][a-z]{2,4})',v='(?::\\d+){0,1}',w='(?=[/?#])',x='(?:'+'(?:'+p+t+v+')|'+'(?:'+q+v+')|'+'(?:'+r+t+u+v+')|'+'(?:'+t+u+v+w+')'+')',y='[/#?]',z='\\([^\\s()<>]+\\)',aa='[^\\s()<>?#]+',ba='[^\\s'+m+n+']',ca=new RegExp(x,'im'),da='(?:'+'(?:'+y+')'+'(?:'+'(?:'+z+'|'+aa+')*'+')*'+')*',ea=new RegExp('('+'(?:'+x+')'+'(?:'+da+')'+')','im'),fa=new RegExp('('+'(?:'+p+t+v+')|'+'(?:'+r+t+u+v+')'+')'),ga=/[\s'";]/,ha=new RegExp(y,'im'),ia=new RegExp('[\\s!"#%&\'()*,-./:;<>?@[\\]^_`{|}\u00ab\u00bb\u2000-\u206F\uff08\uff09]','im'),ja=new RegExp('[\\s()<>?#]','im'),ka=new RegExp('\\s()<>'),la=function(ma){if(ma&&ma.indexOf('@')!=-1){return (fa.exec(ma))?ma:null;}else return ma;};j(l,{match:function(ma){var na=ca.exec(ma);if(!na)return null;var oa=ma.substr(na.index+na[0].length);if(oa.length===0||!(ha.test(oa[0])))return la(na[0]);var pa=0,qa=0,ra=1,sa=qa;for(var ta=1;ta<oa.length;ta++){var ua=oa[ta];if(sa===qa){if(ua==='('){sa=ra;}else if(ha.test(ua)||!(ia.test(ua))){pa=ta;}else if(ja.test(ua))break;}else if(ua===')'){sa=qa;pa=ta;}else if(ka.test(ua))break;}return la(na[0]+oa.substring(0,pa+1));},permissiveMatch:function(ma){return l.matchToPattern(ma,ea);},matchToPattern:function(ma,na){var oa=(na.exec(ma)||[])[1]||null;return la(oa);},trigger:function(ma){return !ga.test(ma.charAt(ma.length-1));}});e.exports=l;});
__d("htmlHyperlink",["Env","htmlize","UntrustedLink","URI","URLScraper","cx"],function(a,b,c,d,e,f){var g=b('Env'),h=b('htmlize'),i=b('UntrustedLink'),j=b('URI'),k=b('URLScraper'),l=b('cx');function m(n,o,p,q){if(typeof n==='undefined'||!n.toString)return '';if(typeof o!=='function')o=h;if(typeof p!=='function')p=h;var n=n.toString(),r=[],s;while((s=k.match(n))){var t=n.indexOf(s);if(t>=0)r.push(o(n.substring(0,t)));var u=p(s),v=s.replace(/"/g,'%22');if(!(/^[a-z][a-z0-9\-+.]+:\/\//i.test(s)))v='http://'+v;if(j.isValidURI(v)){r.push('<a target="_blank" rel="nofollow" '+'class="'+"_553k"+'" '+'href="'+v+'"');if(q&&!j(v).isFacebookURI()){a.UntrustedLink=i;r.push(' onmousedown="UntrustedLink.bootstrap(this, \''+g.lhsh+'\', event)"');}r.push('>'+u+'</a>');}else r.push(u);n=n.substring(t+s.length);}n&&r.push(o(n));return r.join('');}e.exports=m;});
__d("MercuryMessageRenderer",["MercuryAttachmentRenderer","CSS","DOM","DOMQuery","HTML","MercuryEmoji","MercuryLogMessageType","MercuryParticipants","Tooltip","cx","htmlHyperlink","tx"],function(a,b,c,d,e,f){var g=b('MercuryAttachmentRenderer'),h=b('CSS'),i=b('DOM'),j=b('DOMQuery'),k=b('HTML'),l=b('MercuryEmoji'),m=b('MercuryLogMessageType'),n=b('MercuryParticipants'),o=b('Tooltip'),p=b('cx'),q=b('htmlHyperlink'),r=b('tx'),s=["January","February","March","April","May","June","July","August","September","October","November","December"],t={renderDate:function(ma){var na=new Date();na.setHours(0);na.setMinutes(0);na.setSeconds(0);na.setMilliseconds(0);var oa=24*60*60*1000,pa=na.getTime()-ma.getTime();if(pa<=0){return "Today";}else if(pa<oa)return "Yesterday";var qa=s[ma.getMonth()],ra=ma.getDate(),sa=ma.getFullYear();if(sa!=na.getFullYear()){return r._("{month} {date}, {year}",{month:qa,date:ra,year:sa});}else return r._("{month} {date}",{month:qa,date:ra});},renderTooltipFlyout:function(ma,na){na.forEach(function(oa){var pa=i.create('div');i.setContent(pa,oa.name);i.appendContent(ma,pa);});},renderLogMessage:function(ma,na,oa,pa){w(ma,pa);x(na,pa);y(oa,pa);},formatMessageBody:function(ma,na,oa){var pa=(ma||'').replace(/\s+$/,'');if(!na)return v(pa,false,oa);var qa=Object.keys(na).map(function(ta){return window.parseInt(ta);}).sort(function(ta,ua){return ta-ua;}),ra=[],sa=0;qa.forEach(function(ta){var ua=pa.slice(sa,ta);if(ua)ra.push(v(ua,false,oa));sa=ta+na[ta].length;var va=pa.slice(ta,sa);if(va)ra.push(v(va,true,oa));});if(sa<pa.length)ra.push(v(pa.slice(sa),false,oa));return ra.length===0?null:ra.length===1?ra[0]:i.create('span',{},ra);}};function u(ma,na){var oa=ma.replace(/\r\n?/g,'\n').split(/\n{2,}/),pa=[];for(var qa=0;qa<oa.length;qa++){var ra=oa[qa];if(ra.length){pa.push('<p>');pa.push(na(ra));pa.push('</p>');}}return pa.join('');}function v(ma,na,oa){var pa=null;if(ma.length===0&&!na)return pa;function qa(ra){return q(ra,l.htmlEmojiAndEmote,null,true);}pa=oa?u(ma,qa):qa(ma);if(na)return i.create('span',{className:'highlight'},k(pa));return k(pa);}function w(ma,na){var oa='',pa;switch(na.log_message_type){case m.JOINABLE_CREATED:case m.JOINABLE_JOINED:case m.SUBSCRIBE:oa='mercurySubscribeIcon';break;case m.UNSUBSCRIBE:oa='mercuryUnsubscribeIcon';break;case m.THREAD_NAME:oa='mercuryThreadNameIcon';break;case m.THREAD_IMAGE:oa='mercuryThreadImageIcon';break;case m.VIDEO_CALL:pa=na.log_message_data.answered;if(pa||la(na)){oa='mercuryVideoCallIcon';}else oa='mercuryMissedVideoCallIcon';break;case m.PHONE_CALL:pa=na.log_message_data.answered;if(pa){oa='mercuryPhoneCallIcon';}else oa='mercuryMissedPhoneCallIcon';break;case m.SERVER_ERROR:oa='mercuryErrorIcon';break;}h.addClass(ma,oa);}function x(ma,na){switch(na.log_message_type){case m.JOINABLE_CREATED:da(ma,na);break;case m.JOINABLE_JOINED:ea(ma,na);break;case m.SUBSCRIBE:ia(ma,na);break;case m.UNSUBSCRIBE:ja(ma,na);break;case m.VIDEO_CALL:if(la(na)){z(ma,na);}else ba(ma,na);break;case m.PHONE_CALL:aa(ma,na);break;case m.THREAD_NAME:ca(ma,na);break;case m.THREAD_IMAGE:fa(ma,na);break;case m.SERVER_ERROR:ka(ma,na);break;}}function y(ma,na){var oa=na.log_message_type;if(oa==m.THREAD_IMAGE){var pa=na.log_message_data.image;if(pa){var qa=g.renderPreview(pa.preview_url?pa:null);i.setContent(ma,qa);h.addClass(qa,"_z6a");h.show(ma);}}}var z=function(ma,na){n.get(na.author,function(oa){var pa=i.create('span',{className:"_511e"},oa.short_name),qa;switch(na.log_message_data.event_name){case 'installing':qa=i.tx._("{firstname} is setting up video calling...",{firstname:pa});break;case 'installed':qa=i.tx._("{firstname} finished setting up video calling.",{firstname:pa});break;case 'install_canceled':qa=i.tx._("You canceled the video calling installation. ",{firstname:pa});break;}if(qa)i.setContent(ma,qa);});},aa=function(ma,na){var oa=na.log_message_data.caller,pa=na.log_message_data.callee,qa=[oa,pa];n.getMulti(qa,function(ra){if(oa==n.user){var sa=i.create('span',{className:"_511e"},ra[pa].short_name),ta;if(na.log_message_data.answered){ta=i.tx._("You called {firstname}.",{firstname:sa});}else ta=i.tx._("{firstname} missed a call from you. ",{firstname:sa});}else{var ua=i.create('span',{className:"_511e"},ra[oa].short_name);if(na.log_message_data.answered){ta=i.tx._("{firstname} called you.",{firstname:ua});}else ta=i.tx._("You missed a call from {firstname}. ",{firstname:ua});}i.setContent(ma,ta);});},ba=function(ma,na){var oa=na.log_message_data.caller,pa=na.log_message_data.callee,qa=[oa,pa];n.getMulti(qa,function(ra){if(oa==n.user){var sa=i.create('span',{className:"_511e"},ra[pa].short_name),ta;if(na.log_message_data.answered){ta=i.tx._("You called {firstname}.",{firstname:sa});}else ta=i.tx._("{firstname} missed a call from you. ",{firstname:sa});}else{var ua=i.create('span',{className:"_511e"},ra[oa].short_name);if(na.log_message_data.answered){ta=i.tx._("{firstname} called you.",{firstname:ua});}else ta=i.tx._("You missed a call from {firstname}. ",{firstname:ua});}i.setContent(ma,ta);});},ca=function(ma,na){var oa=na.log_message_data.name,pa=i.create('b',{},oa);if(na.author==n.user){if(oa){i.setContent(ma,i.tx._("You named the conversation: {name}.",{name:pa}));}else i.setContent(ma,i.tx._("You removed the conversation name."));}else n.get(na.author,function(qa){var ra,sa=ga(qa);if(oa){ra=i.tx._("{actor} named the conversation: {name}.",{actor:sa,name:pa});}else ra=i.tx._("{actor} removed the conversation name.",{actor:sa});i.setContent(ma,ra);});},da=function(ma,na){if(na.author==n.user){i.setContent(ma,i.tx._("Other people can join this chat from News Feed and add their friends."));}else n.get(na.author,function(oa){var pa=ga(oa);i.setContent(ma,i.tx._("{actor} shared this chat to News Feed. Other people can join and add their friends.",{actor:pa}));});},ea=function(ma,na){var oa=na.log_message_data.joined_participant;if(oa==n.user){i.setContent(ma,i.tx._("You joined the chat. Other people can join from News Feed and add their friends."));}else n.get(oa,function(pa){var qa=ga(pa);i.setContent(ma,i.tx._("{actor} joined the chat.",{actor:qa}));});},fa=function(ma,na){if(na.author==n.user){if(na.log_message_data.image){i.setContent(ma,i.tx._("You changed the conversation picture."));}else i.setContent(ma,i.tx._("You removed the conversation picture."));}else n.get(na.author,function(oa){var pa=ga(oa),qa;if(na.log_message_data.image){qa=i.tx._("{actor} changed the conversation picture.",{actor:pa});}else qa=i.tx._("{actor} removed the conversation picture.",{actor:pa});i.setContent(ma,qa);});},ga=function(ma){if(ma.href)return i.create('a',{href:ma.href,className:"_511e"},ma.name);return ma.name;},ha=function(ma){var na=ma.indexOf(n.user);if(na>0)return ma.splice(na,1).concat(ma);return ma;},ia=function(ma,na){var oa=ha(na.log_message_data.added_participants),pa=null,qa;if(oa.length==1){pa=[na.author,oa[0]];n.getMulti(pa,function(ra){if(na.author==n.user){qa=i.tx._("You added {subscriber1}.",{subscriber1:ga(ra[oa[0]])});}else if(oa[0]==n.user){qa=i.tx._("{actor} added you.",{actor:ga(ra[na.author])});}else qa=i.tx._("{actor} added {subscriber1}.",{actor:ga(ra[na.author]),subscriber1:ga(ra[oa[0]])});i.setContent(ma,qa);});}else if(oa.length==2){pa=[na.author].concat(oa);n.getMulti(pa,function(ra){if(na.author==n.user){qa=i.tx._("You added {subscriber1} and {subscriber2}.",{subscriber1:ga(ra[oa[0]]),subscriber2:ga(ra[oa[1]])});}else if(oa[0]==n.user){qa=i.tx._("{actor} added you and {subscriber2}.",{actor:ga(ra[na.author]),subscriber2:ga(ra[oa[1]])});}else qa=i.tx._("{actor} added {subscriber1} and {subscriber2}.",{actor:ga(ra[na.author]),subscriber1:ga(ra[oa[0]]),subscriber2:ga(ra[oa[1]])});i.setContent(ma,qa);});}else if(oa.length==3){pa=[na.author].concat(oa);n.getMulti(pa,function(ra){if(na.author==n.user){qa=i.tx._("You added {subscriber1}, {subscriber2} and {subscriber3}.",{subscriber1:ga(ra[oa[0]]),subscriber2:ga(ra[oa[1]]),subscriber3:ga(ra[oa[2]])});}else if(oa[0]==n.user){qa=i.tx._("{actor} added you, {subscriber2} and {subscriber3}.",{actor:ga(ra[na.author]),subscriber2:ga(ra[oa[1]]),subscriber3:ga(ra[oa[2]])});}else qa=i.tx._("{actor} added {subscriber1}, {subscriber2} and {subscriber3}.",{actor:ga(ra[na.author]),subscriber1:ga(ra[oa[0]]),subscriber2:ga(ra[oa[1]]),subscriber3:ga(ra[oa[2]])});i.setContent(ma,qa);});}else{pa=[na.author].concat(oa);n.getMulti(pa,function(ra){var sa=i.tx._("{num} more",{num:oa.length-2}),ta=i.create('span',{className:'more'},sa),ua=i.create('div');t.renderTooltipFlyout(ua,oa.slice(2).map(function(wa){return ra[wa];}));if(na.author==n.user){qa=i.tx._("You added {subscriber1}, {subscriber2} and {more_people}.",{subscriber1:ga(ra[oa[0]]),subscriber2:ga(ra[oa[1]]),more_people:ta});}else if(oa[0]==n.user){qa=i.tx._("{actor} added you, {subscriber2} and {more_people}.",{actor:ga(ra[na.author]),subscriber2:ga(ra[oa[1]]),more_people:ta});}else qa=i.tx._("{actor} added {subscriber1}, {subscriber2} and {more_people}.",{actor:ga(ra[na.author]),subscriber1:ga(ra[oa[0]]),subscriber2:ga(ra[oa[1]]),more_people:ta});i.setContent(ma,qa);var va=j.find(ma,'span.more');o.set(va,ua,'above','center');});}},ja=function(ma,na){n.get(na.author,function(oa){var pa;if(na.author==n.user){pa=i.tx._("You left the conversation.");}else pa=i.tx._("{actor} left the conversation.",{actor:ga(oa)});i.setContent(ma,pa);});},ka=function(ma,na){var oa="We were unable to fetch previous messages in this conversation.";i.setContent(ma,oa);},la=function(ma){return ma.log_message_data.event_name==='installing'||ma.log_message_data.event_name==='install_canceled';};e.exports=t;});
__d("MercurySheetPolicy",[],function(a,b,c,d,e,f){var g={canReplaceOpenSheet:function(h,i){if(h.getType()==i.getType())return false;if(h.isPermanent()&&!i.isPermanent())return false;return true;}};e.exports=g;});
__d("MercurySheetView",["Animation","MercurySheetPolicy","CSS","DOM","Style","MercurySheetTemplates","Vector","copyProperties","cx"],function(a,b,c,d,e,f){var g=b('Animation'),h=b('MercurySheetPolicy'),i=b('CSS'),j=b('DOM'),k=b('Style'),l=b('MercurySheetTemplates'),m=b('Vector'),n=b('copyProperties'),o=b('cx'),p=5000,q=function(r,s,t){this._threadID=r;this._rootElement=s;this._tabMainElement=t;this._openSheet=null;};n(q.prototype,{destroy:function(){j.empty(this._rootElement);},_openCommon:function(r,s){if(this._openSheet&&!h.canReplaceOpenSheet(this._openSheet,r))return;this.clear(function(){this._openSheet=r;var t=l[':fb:mercury:tab-sheet:loading'].build().getRoot();j.setContent(this._rootElement,t);i.show(t);i.show(this._rootElement);r.render();if(s){i.addClass(this._tabMainElement,'sheetSlide');i.addClass(this._tabMainElement,"_1sk4");var u=m.getElementDimensions(this._rootElement).y;k.set(this._rootElement,'bottom',u+'px');this._animation=new g(this._rootElement).to('bottom',0).duration(150).ease(g.ease.both).ondone(function(){i.removeClass(this._tabMainElement,'sheetSlide');i.removeClass(this._tabMainElement,"_1sk4");}.bind(this)).go();}if(!r.isPermanent()){var v=p;if(r.getCloseTimeout)v=r.getCloseTimeout();this._sheetCloseHandler=this.close.bind(this,r).defer(v,false);if(r.timeoutCanBeReset)r.setResetTimeoutCallback(this.resetTimeout.bind(this));}}.bind(this));},resetTimeout:function(r,s){clearTimeout(this._sheetCloseHandler);this._sheetCloseHandler=this.close.bind(this,r).defer(s,false);},set:function(r){return this._openCommon(r,false);},open:function(r){return this._openCommon(r,true);},close:function(r,s){if(this._openSheet!=r)return;if(!this._openSheet){s&&s();return;}if(this._animation)this._animation.stop();if(this._sheetCloseHandler){clearTimeout(this._sheetCloseHandler);this._sheetCloseHandler=null;}i.addClass(this._tabMainElement,'sheetSlide');i.addClass(this._tabMainElement,"_1sk4");var t=m.getElementDimensions(this._rootElement).y;this._animation=new g(this._rootElement).to('bottom',t+'px').duration(100).ease(g.ease.begin).ondone(function(){j.empty(this._rootElement);i.hide(this._rootElement);i.removeClass(this._tabMainElement,'sheetSlide');i.removeClass(this._tabMainElement,"_1sk4");this._openSheet=null;s&&s();}.bind(this)).go();},clear:function(r){this.close(this._openSheet,r);}});e.exports=q;});
__d("Token",["CSS","DataStore","DOM","copyProperties","tx"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DataStore'),i=b('DOM'),j=b('copyProperties'),k=b('tx');function l(m,n){this.info=m;this.paramName=n;}j(l.prototype,{getInfo:function(){return this.info;},getText:function(){return this.info.text;},getValue:function(){return this.info.uid;},isFreeform:function(){return !!this.info.freeform;},setSelected:function(m){g.conditionClass(this.getElement(),'uiTokenSelected',m);return this;},getElement:function(){if(!this.element)this.setElement(this.createElement());return this.element;},setElement:function(m){h.set(m,'Token',this);this.element=m;return this;},isRemovable:function(){return g.hasClass(this.element,'removable');},createElement:function(m,n){var o=this.paramName,p=this.getText(),q=this.getValue(),r=i.create('a',{href:'#','aria-label':k._("Remove {item}",{item:p}),className:'remove uiCloseButton uiCloseButtonSmall'});if(m)g.addClass(r,'uiCloseButtonSmallGray');var s=i.create('input',{type:'hidden',value:q,name:o+'[]',autocomplete:'off'}),t=i.create('input',{type:'hidden',value:p,name:'text_'+o+'[]',autocomplete:'off'}),u=i.create('span',{className:'removable uiToken'},[p,s,t,r]);if(m)g.addClass(u,'uiTokenGray');if(n){var v=i.create('i',{className:n});i.prependContent(u,v);}return u;}});e.exports=l;});
__d("WeakToken",["Class","CSS","Token","copyProperties"],function(a,b,c,d,e,f){var g=b('Class'),h=b('CSS'),i=b('Token'),j=b('copyProperties');function k(l,m){this.parent.construct(this,l,m);}g.extend(k,i);j(k.prototype,{createElement:function(){var l=this.parent.createElement(true,'UFIWeakReferenceIcon');h.addClass(l,'uiTokenWeakReference');return l;}});e.exports=k;});
__d("Tokenizer",["Arbiter","ArbiterMixin","CSS","DOM","DOMQuery","DataStore","Event","Focus","Input","Keys","Parent","StickyPlaceholderInput","Style","TextMetrics","Token","UserAgent","WeakToken","copyProperties","createObjectFrom","emptyFunction"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('CSS'),j=b('DOM'),k=b('DOMQuery'),l=b('DataStore'),m=b('Event'),n=b('Focus'),o=b('Input'),p=b('Keys'),q=b('Parent'),r=b('StickyPlaceholderInput'),s=b('Style'),t=b('TextMetrics'),u=b('Token'),v=b('UserAgent'),w=b('WeakToken'),x=b('copyProperties'),y=b('createObjectFrom'),z=b('emptyFunction');function aa(ba,ca){this.element=ba;this.typeahead=ca;this.input=ca.getCore().getElement();l.set(this.element,'Tokenizer',this);}aa.getInstance=function(ba){var ca=q.byClass(ba,'uiTokenizer');return ca?l.get(ca,'Tokenizer'):null;};x(aa.prototype,h,{inline:false,maxTokens:null,excludeDuplicates:true,placeholder:'',init:function(ba,ca,da,ea){this.init=z;this.tokenarea=ba;this.paramName=ca;if(!this.placeholder)this.placeholder=this.input.getAttribute('data-placeholder')||'';x(this,ea||{});this.initEvents();this.initTypeahead();this.reset(da);this.initBehaviors();g.inform('Tokenizer/init',this,g.BEHAVIOR_PERSISTENT);},reset:function(ba){this.tokens=[];this.unique={};if(ba){this.populate(ba);}else j.empty(this.tokenarea);this.updateTokenarea();},populate:function(ba){var ca=[];this.tokens=this.getTokenElements().map(function(da,ea){var fa=ba[ea];ca.push(this._tokenKey(fa));return this.createToken(fa,da);},this);this.unique=y(ca,this.tokens);},getElement:function(){return this.element;},getTypeahead:function(){return this.typeahead;},getInput:function(){return this.input;},initBehaviors:function(){this.behaviors=this.behaviors||[];if(this.behaviors instanceof Array){this.behaviors.forEach(function(da){da.behavior(this,da.config);}.bind(this));}else for(var ba in (this.behaviors||{})){var ca=window.TokenizerBehaviors&&window.TokenizerBehaviors[ba];ca.call(null,this,this.behaviors[ba]);}},initTypeahead:function(){var ba=this.typeahead.getCore();ba.resetOnSelect=true;ba.setValueOnSelect=false;ba.preventFocusChangeOnTab=true;if(this.inline){var ca=this.typeahead.getView();i.addClass(ca.getElement(),'uiInlineTokenizerView');}this.typeahead.subscribe('select',function(da,ea){var fa=ea.selected;if('uid' in fa){this.updateInput();this.addToken(this.createToken(fa));}}.bind(this));this.typeahead.subscribe('blur',this.handleBlur.bind(this));},handleBlur:function(event){this.inform('blur',{event:event});this.updatePlaceholder();},initEvents:function(){var ba=this.handleEvents.bind(this),ca=v.firefox()<4?'keypress':'keydown';m.listen(this.tokenarea,{click:ba,keydown:ba});m.listen(this.input,'paste',this.paste.bind(this));m.listen(this.input,ca,this.keydown.bind(this));},handleEvents:function(event){var ba=event.getTarget(),ca=ba&&this.getTokenElementFromTarget(ba);if(!ca)return;if(event.type!='keydown'||m.getKeyCode(event)==p.RETURN)this.processEvents(event,ba,ca);},processEvents:function(event,ba,ca){if(q.byClass(ba,'remove')){var da=ca.nextSibling;da=da&&k.scry(ca.nextSibling,'.remove')[0];var ea=this.getTokenFromElement(ca);ea=this.addTokenData(ea,ba);this.removeToken(ea);this.focusOnTokenRemoval(event,da);event.kill();}},focusOnTokenRemoval:function(event,ba){n.set(event.type=='keydown'&&ba||this.input);},addTokenData:function(ba,ca){return ba;},keydown:function(event){this.inform('keydown',{event:event});var ba=m.getKeyCode(event),ca=this.input;if(this.inline&&ba==p.BACKSPACE&&o.isEmpty(ca)){var da=this.getLastToken();if(da&&da.isRemovable())this.removeToken(da);}this.updateInput();},paste:function(event){this.inform('paste',{event:event});this.updateInput(true);},focusInput:function(){n.set(this.input);},updateInput:function(ba){if(!this.inline)return;setTimeout(function(){this.adjustWidth(this.input.value);if(ba)this.input.value=this.input.value;}.bind(this),20);r.setPlaceholderText(this.input,'');},setPlaceholder:function(ba){this.placeholder=ba;if(this.stickyPlaceholder)r.setPlaceholderText(this.input,ba);this.updatePlaceholder();},updatePlaceholder:function(){if(!this.inline||this.input.value)return;var ba=!this.tokens.length,ca='';if(ba||this.stickyPlaceholder){this.adjustWidth(this.placeholder);ca=this.placeholder;}else this.adjustWidth(this.input.value);r.setPlaceholderText(this.input,ca);},adjustWidth:function(ba){if(!this.inline||!this._getIsInDOM())return;if(!ba&&this.stickyPlaceholder&&this.input.value==='')ba=this.placeholder;var ca=this._getMetrics().measure(ba),da=ca.width+this._getWidthOffset()+10;s.set(this.input,'width',da+'px');},getToken:function(ba){return this.unique[ba]||null;},getTokens:function(){return this.tokens||[];},getTokenElements:function(){return k.scry(this.tokenarea,'span.uiToken');},getTokenElementFromTarget:function(ba){return q.byClass(ba,'uiToken');},getTokenFromElement:function(ba){return l.get(ba,'Token');},getTokenValues:function(){if(!this.tokens)return [];return this.tokens.map(function(ba){return ba.getValue();});},getFirstToken:function(){return this.tokens[0]||null;},getLastToken:function(){return this.tokens[this.tokens.length-1]||null;},hasMaxTokens:function(){return this.maxTokens&&this.maxTokens<=this.tokens.length;},createToken:function(ba,ca){var da=this.getToken(this._tokenKey(ba));if(!da)da=ba.weak_reference?new w(ba,this.paramName):new u(ba,this.paramName);ca&&da.setElement(ca);return da;},addToken:function(ba){if(this.hasMaxTokens())return;var ca=this._tokenKey(ba.getInfo());if(ca in this.unique)return;this.unique[ca]=ba;this.tokens.push(ba);this.insertToken(ba);this.updateTokenarea();this.inform('addToken',ba);g.inform('Form/change',{node:this.element});},insertToken:function(ba){j.appendContent(this.tokenarea,ba.getElement());},removeToken:function(ba){if(!ba)return;var ca=this.tokens.indexOf(ba);if(ca<0)return;this.tokens.splice(this.tokens.indexOf(ba),1);delete this.unique[this._tokenKey(ba.getInfo())];j.remove(ba.getElement());this.updateTokenarea();this.inform('removeToken',ba);g.inform('Form/change',{node:this.element});},removeAllTokens:function(){this.reset();this.inform('removeAllTokens');},updateTokenarea:function(){var ba=this.typeahead.getCore(),ca=this.getTokenValues();if(this.excludeDuplicates){this._exclusions||(this._exclusions=ba.getExclusions());ba.setExclusions(ca.concat(this._exclusions));}ba.setEnabled(!this.hasMaxTokens());this.updateTokenareaVisibility();this.updatePlaceholder();},updateTokenareaVisibility:function(){i.conditionShow(this.tokenarea,this.tokens.length!==0);},_tokenKey:function(ba){return ba.uid+(ba.freeform?':':'');},_widthOffset:null,_getWidthOffset:function(){if(this._widthOffset===null){var ba=this.input.clientWidth,ca=s.getFloat(this.input,'width');if(ba==ca){this._widthOffset=s.getFloat(this.input,'paddingLeft')+s.getFloat(this.input,'paddingRight');}else this._widthOffset=0;}return this._widthOffset;},_metrics:null,_getMetrics:function(){if(!this._metrics)this._metrics=new t(this.input,this.inline);return this._metrics;},_getIsInDOM:function(){return this._isInDOM||(this._isInDOM=k.contains(document.body,this.input));}});aa.init=function(ba,ca){ba.init(ca.tokenarea,ca.param_name,ca.initial_info,ca.options);};e.exports=aa;});
__d("MercuryTypeahead",["Event","ArbiterMixin","DOM","Input","MercuryTypeaheadTemplates","Tokenizer","Typeahead","TypeaheadCore","copyProperties","cx"],function(a,b,c,d,e,f){var g=b('Event'),h=b('ArbiterMixin'),i=b('DOM'),j=b('Input'),k=b('MercuryTypeaheadTemplates'),l=b('Tokenizer'),m=b('Typeahead'),n=b('TypeaheadCore'),o=b('copyProperties'),p=b('cx'),q=function(r,s){this._domElement=null;this._typeahead=null;this._tokenizer=null;this._placeholder='';this._exclusions=[];this._viewNodeOrID=null;this._viewOptions={renderer:'compact',autoSelect:true};this._tokenizerBehaviors=[];this._dataSource=r;this._view=s;};o(q.prototype,h);o(q.prototype,{setPlaceholder:function(r){this._placeholder=r;return this;},setExcludedParticipants:function(r){this._exclusions=[];r.forEach(function(s){var t=s.indexOf(':');if(s.substr(0,t)=='fbid')this._exclusions.push(s.substr(t+1));}.bind(this));return this;},setViewNodeID:function(r){this._viewNodeOrID=r;},setViewNode:function(r){this._viewNodeOrID=r;},setFullWidthView:function(r){var s=i.create('div',{className:"_4ck uiTypeaheadView"});i.setContent(r,s);this.setViewNode(s);},setViewOption:function(r,s){this._viewOptions[r]=s;},addTokenizerBehavior:function(r){this._tokenizerBehaviors.push(r);},build:function(r){if(this._domElement)return;var s=k[':fb:mercury:tokenizer'].build(),t=k[':fb:mercury:typeahead'].build();this._domElement=s.getRoot();i.appendContent(this._domElement,t.getRoot());var u=t.getNode('textfield');j.setPlaceholder(u,this._placeholder);u.setAttribute('data-placeholder',this._placeholder);var v={node_id:this._viewNodeOrID,ctor:this._view,options:this._viewOptions},w={ctor:n,options:{setValueOnSelect:true}};this._typeahead=new m(this._dataSource,v,w,t.getRoot());this._typeahead.init();var x={inline:true,behaviors:this._tokenizerBehaviors};this._tokenizer=new l(this._domElement,this._typeahead);this._tokenizer.init(s.getNode('tokenarea'),'participants',[],x);this._tokenizer.subscribe(['addToken','removeToken','removeAllTokens'],function(){this.inform('tokens-changed');}.bind(this));g.listen(u,'focus',function(){this._resetDataSource();this._typeahead.init();}.bind(this));g.listen(this._domElement,'click',this.focus.bind(this));},getElement:function(){return this._domElement;},getSelectedParticipantIDs:function(){var r=[];if(this._tokenizer)(this._tokenizer.getTokenValues()||[]).forEach(function(s){r.push('fbid:'+s);});return r;},getTokens:function(){var r=[];if(this._tokenizer)r=this._tokenizer.getTokens();return r;},getTokenizer:function(){return this._tokenizer;},reset:function(){this._tokenizer&&this._tokenizer.removeAllTokens();this._typeahead&&this._typeahead.getCore().reset();},focus:function(){this._tokenizer&&this._tokenizer.focusInput();},getTypeahead:function(){return this._typeahead;},_resetDataSource:function(){this._dataSource.setExclusions(this._exclusions);}});e.exports=q;});
__d("ControlledReferer",["Event","URI","UserAgent"],function(a,b,c,d,e,f){var g=b('Event'),h=b('URI'),i=b('UserAgent'),j={useFacebookReferer:function(k,l,m){var n=false;function o(){if(n)return;var q=k.contentWindow.location.pathname;if(q!=='/intern/common/referer_frame.php'&&q!=='/common/referer_frame.php')return;n=true;k.contentWindow.document.body.style.margin=0;l();}var p;if(document.domain!=='facebook.com'){p='/intern/common/referer_frame.php';}else if(i.opera()){p='/common/referer_frame.php';}else if(h().isSecure()){p='https://s-static.ak.facebook.com/common/referer_frame.php';}else p='http://static.ak.facebook.com/common/referer_frame.php';if(m)p+='?fb_source='+m;g.listen(k,'load',o);k.src=p;},useFacebookRefererHtml:function(k,l,m){j.useFacebookReferer(k,function(){k.contentWindow.document.body.innerHTML=l;},m);}};e.exports=j;});
__d("swfobject",["AsyncRequest","Bootloader","ControlledReferer","copyProperties","CSS","DOM","function-extensions","ge","htmlSpecialChars"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('Bootloader'),i=b('ControlledReferer'),j=b('copyProperties'),k=b('CSS'),l=b('DOM');b('function-extensions');var m=b('ge'),n=b('htmlSpecialChars');if(typeof o=="undefined")var o={};if(typeof o.util=="undefined")o.util={};if(typeof o.SWFObjectUtil=="undefined")o.SWFObjectUtil={};o.SWFObject=function(u,v,w,x,y,z,aa,ba,ca,da){if(!document.getElementById)return;this.DETECT_KEY=da?da:'detectflash';this.skipDetect=o.util.getRequestParameter(this.DETECT_KEY);this.params={};this.variables={};this.attributes=[];this.fallback_html='';this.fallback_js_fcn=function(){};if(u)this.setAttribute('swf',u);if(v)this.setAttribute('id',v);if(w)this.setAttribute('width',w);if(x)this.setAttribute('height',x);this.installedVer=o.SWFObjectUtil.getPlayerVersion();if(y){if(!(y instanceof Array))y=[y];var ea;y.forEach(function(ha){ea=new o.PlayerVersion(ha.toString().split('.'));if(ea.major==this.installedVer.major){this.setAttribute('version',ea);return;}else if(!this.getAttribute('version')||ea.major<this.getAttribute('version').major)this.setAttribute('version',ea);}.bind(this));}if(!window.opera&&document.all&&this.installedVer.major>7)if(!o.unloadSet){o.SWFObjectUtil.prepUnload=function(){var ha=function(){},ia=function(){};window.attachEvent("onunload",o.SWFObjectUtil.cleanupSWFs);};window.attachEvent("onbeforeunload",o.SWFObjectUtil.prepUnload);o.unloadSet=true;}if(z)this.addParam('bgcolor',z);var fa=aa?aa:'high';this.addParam('quality',fa);this.setAttribute('useExpressInstall',false);this.setAttribute('doExpressInstall',false);var ga=(ba)?ba:window.location;this.setAttribute('xiRedirectUrl',ga);this.setAttribute('redirectUrl','');if(ca)this.setAttribute('redirectUrl',ca);this.setAttribute('useIframe',false);};o.SWFObject.ieWorkaroundApplied=false;o.SWFObject.ensureIEWorkaroundAttached=function(){if(!o.SWFObject.ieWorkaroundApplied&&document.attachEvent){o.SWFObject.ieWorkaroundApplied=true;document.attachEvent('onpropertychange',o.SWFObject.onDocumentPropertyChange);}};o.SWFObject.onDocumentPropertyChange=function(event){if(event.propertyName=="title"){var u=document.title;if(u!=null&&u.indexOf('#!')!=-1){u=u.substring(0,u.indexOf('#!'));document.title=u;}}};j(o.SWFObject.prototype,{useExpressInstall:function(u){this.xiSWFPath=!u?"/swf/expressinstall.swf":u;this.setAttribute('useExpressInstall',true);},setAttribute:function(u,v){this.attributes[u]=v;},getAttribute:function(u){return this.attributes[u]||"";},addParam:function(u,v){this.params[u]=v;},getParams:function(){return this.params;},addVariable:function(u,v){this.variables[u]=v;},getVariable:function(u){return this.variables[u]||"";},getVariables:function(){return this.variables;},getVariablePairs:function(){var u=[],v,w=this.getVariables();for(v in w)u[u.length]=v+"="+w[v];return u.join('&');},getSWFHTML:function(){var u,v,w;if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","PlugIn");this.setAttribute('swf',this.xiSWFPath);}v={type:'application/x-shockwave-flash',src:this.getAttribute('swf'),width:this.getAttribute('width'),height:this.getAttribute('height'),style:this.getAttribute('style')||'display: block;',id:this.getAttribute('id'),name:this.getAttribute('id')};var x=this.getParams();for(var y in x)v[y]=x[y];w=this.getVariablePairs();if(w)v.flashvars=w;u=t('embed',v,null);}else{if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","ActiveX");this.setAttribute('swf',this.xiSWFPath);}v={id:this.getAttribute('id'),classid:'clsid:D27CDB6E-AE6D-11cf-96B8-444553540000',width:this.getAttribute('width'),height:this.getAttribute('height'),style:this.getAttribute('style')||'display: block;'};var z=t('param',{name:'movie',value:this.getAttribute('swf')},null),x=this.getParams();for(var y in x)z+=t('param',{name:y,value:x[y]},null);w=this.getVariablePairs();if(w)z+=t('param',{name:'flashvars',value:w},null);u=t('object',v,z);}return u;},write:function(u){if(this.getAttribute('useExpressInstall')){var v=new o.PlayerVersion([6,0,65]);if(this.installedVer.versionIsValid(v)&&!this.installedVer.versionIsValid(this.getAttribute('version'))){this.setAttribute('doExpressInstall',true);this.addVariable("MMredirectURL",escape(this.getAttribute('xiRedirectUrl')));document.title=document.title.slice(0,47)+" - Flash Player Installation";this.addVariable("MMdoctitle",document.title);}}var w=(typeof u=='string')?document.getElementById(u):u;if(!w)return false;k.addClass(w,'swfObject');w.setAttribute('data-swfid',this.getAttribute('id'));if(this.skipDetect||this.getAttribute('doExpressInstall')||this.installedVer.versionIsValid(this.getAttribute('version'))){if(!this.getAttribute('useIframe')){o.SWFObject.ensureIEWorkaroundAttached();w.innerHTML=this.getSWFHTML();}else this._createIframe(w);return true;}else{if(this.getAttribute('redirectUrl')!="")document.location.replace(this.getAttribute('redirectUrl'));var x=this.getAttribute('version').major+'.'+this.getAttribute('version').minor+'.'+this.getAttribute('version').release+'.'+this.getAttribute('version').build,y=this.installedVer.major+'.'+this.installedVer.minor+'.'+this.installedVer.release+'.'+this.installedVer.build;this.fallback_js_fcn(y,x);w.innerHTML=this.fallback_html;}return false;},_createIframe:function(u){var v=l.create('iframe',{width:this.getAttribute('width'),height:this.getAttribute('height'),frameBorder:0});l.empty(u);u.appendChild(v);i.useFacebookRefererHtml(v,this.getSWFHTML(),this.getAttribute('iframeSource'));}});o.SWFObjectUtil.getPlayerVersion=function(){var u=new o.PlayerVersion([0,0,0,0]),v;if(navigator.plugins&&navigator.mimeTypes.length){for(var w=0;w<navigator.plugins.length;w++)try{var y=navigator.plugins[w];if(y.name=='Shockwave Flash'){v=new o.PlayerVersion(y.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+(r|d)|\s+b[0-9]+)/,".").split("."));if(typeof u=='undefined'||v.major>u.major||(v.major==u.major&&(v.minor>u.minor||(v.minor==u.minor&&(v.release>u.release||(v.release==u.release&&v.build>u.build))))))u=v;}}catch(x){}}else if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0){var z=1,aa=3;while(z)try{aa++;z=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+aa);u=new o.PlayerVersion([aa,0,0]);}catch(ba){z=null;}}else{try{var z=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");}catch(ca){try{var z=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");u=new o.PlayerVersion([6,0,21]);z.AllowScriptAccess="always";}catch(da){if(u.major==6)return u;}try{z=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");}catch(ea){}}if(z!=null)u=new o.PlayerVersion(z.GetVariable("$version").split(" ")[1].split(","));}return u;};o.PlayerVersion=function(u){this.major=u[0]!=null?parseInt(u[0],10):0;this.minor=u[1]!=null?parseInt(u[1],10):0;this.release=u[2]!=null?parseInt(u[2],10):0;this.build=u[3]!=null?parseInt(u[3],10):0;};o.PlayerVersion.prototype.versionIsValid=function(u){if(this.major<u.major)return false;if(this.major>u.major)return true;if(this.minor<u.minor)return false;if(this.minor>u.minor)return true;if(this.release<u.release)return false;if(this.release>u.release)return true;if(this.build<u.build)return false;return true;};o.util={getRequestParameter:function(u){var v=document.location.search||document.location.hash;if(u==null)return v;if(v){var w=v.substring(1).split("&");for(var x=0;x<w.length;x++)if(w[x].substring(0,w[x].indexOf("="))==u)return w[x].substring((w[x].indexOf("=")+1));}return "";}};o.SWFObjectUtil.cleanupSWFs=function(){var u=document.getElementsByTagName("OBJECT");for(var v=u.length-1;v>=0;v--){u[v].style.display='none';for(var w in u[v])if(typeof u[v][w]=='function')u[v][w]=function(){};}};if(!document.getElementById&&document.all)document.getElementById=function(u){return document.all[u];};var p=o.util.getRequestParameter,q=o.SWFObject,r=o.SWFObject;o.spawn_flash_update_dialog=function(){new g().setURI('/ajax/flash_update_dialog.php').setMethod('GET').setReadOnly(true).send();};function s(u,v){var w=m(u),x=o.SWFObjectUtil.getPlayerVersion(),y;v.forEach(function(ba){ba=new o.PlayerVersion(ba.toString().split('.'));if(ba.major==x.major){y=ba;return;}else if(typeof y=='undefined'||ba.major<y.major)y=ba;}.bind(this));if(w&&x.major>0){var z=x.major+'.'+x.minor+'.'+x.release+'.'+x.build,aa=y.major+'.'+y.minor+'.'+y.release+'.'+y.build;l.setContent(w,l.tx._("Flash {required-version} is required to view this content. Your current version is {current-version}. Please download the latest Flash Player.",{'required-version':aa,'current-version':z}));}}o.showFlashErrorDialog=function(u,v){h.loadModules(['ErrorDialog'],function(w){w.show(u,v);});};function t(u,v,w){var x=/^[A-Za-z0-9\-]+$/;if(!u.match(x))throw new Error('Invalid tag '+u);var y='<'+u;for(var z in v){if(!z.match(x))throw new Error('Invalid attr '+z);y+=' '+z+'="'+n(v[z])+'"';}if(w===null){return y+'/>';}else return y+'>'+w+'</'+u+'>';}e.exports=a.deconcept||o;});
__d("swfobject2",[],function(a,b,c,d,e,f){var g=function(){var h="undefined",i="object",j="Shockwave Flash",k="ShockwaveFlash.ShockwaveFlash",l="application/x-shockwave-flash",m="SWFObjectExprInst",n="onreadystatechange",o=window,p=document,q=navigator,r=false,s=[ka],t=[],u=[],v=[],w,x,y,z,aa=false,ba=false,ca,da,ea=true,fa=function(){var eb=typeof p.getElementById!=h&&typeof p.getElementsByTagName!=h&&typeof p.createElement!=h,fb=q.userAgent.toLowerCase(),gb=q.platform.toLowerCase(),hb=gb?/win/.test(gb):/win/.test(fb),ib=gb?/mac/.test(gb):/mac/.test(fb),jb=/webkit/.test(fb)?parseFloat(fb.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,kb=!+"\v1",lb=[0,0,0],mb=null;if(typeof q.plugins!=h&&typeof q.plugins[j]==i){mb=q.plugins[j].description;if(mb&&!(typeof q.mimeTypes!=h&&q.mimeTypes[l]&&!q.mimeTypes[l].enabledPlugin)){r=true;kb=false;mb=mb.replace(/^.*\s+(\S+\s+\S+$)/,"$1");lb[0]=parseInt(mb.replace(/^(.*)\..*$/,"$1"),10);lb[1]=parseInt(mb.replace(/^.*\.(.*)\s.*$/,"$1"),10);lb[2]=/[a-zA-Z]/.test(mb)?parseInt(mb.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0;}}else if(typeof o.ActiveXObject!=h)try{var ob=new ActiveXObject(k);if(ob){mb=ob.GetVariable("$version");if(mb){kb=true;mb=mb.split(" ")[1].split(",");lb=[parseInt(mb[0],10),parseInt(mb[1],10),parseInt(mb[2],10)];}}}catch(nb){}return {w3:eb,pv:lb,wk:jb,ie:kb,win:hb,mac:ib};}(),ga=function(){if(!fa.w3)return;if((typeof p.readyState!=h&&p.readyState=="complete")||(typeof p.readyState==h&&(p.getElementsByTagName("body")[0]||p.body)))ha();if(!aa){if(typeof p.addEventListener!=h)p.addEventListener("DOMContentLoaded",ha,false);if(fa.ie&&fa.win){p.attachEvent(n,function(){if(p.readyState=="complete"){p.detachEvent(n,arguments.callee);ha();}});if(o==top)(function(){if(aa)return;try{p.documentElement.doScroll("left");}catch(eb){setTimeout(arguments.callee,0);return;}ha();})();}if(fa.wk)(function(){if(aa)return;if(!/loaded|complete/.test(p.readyState)){setTimeout(arguments.callee,0);return;}ha();})();ja(ha);}}();function ha(){if(aa)return;try{var fb=p.getElementsByTagName("body")[0].appendChild(xa("span"));fb.parentNode.removeChild(fb);}catch(eb){return;}aa=true;var gb=s.length;for(var hb=0;hb<gb;hb++)s[hb]();}function ia(eb){if(aa){eb();}else s[s.length]=eb;}function ja(eb){if(typeof o.addEventListener!=h){o.addEventListener("load",eb,false);}else if(typeof p.addEventListener!=h){p.addEventListener("load",eb,false);}else if(typeof o.attachEvent!=h){ya(o,"onload",eb);}else if(typeof o.onload=="function"){var fb=o.onload;o.onload=function(){fb();eb();};}else o.onload=eb;}function ka(){if(r){la();}else ma();}function la(){var eb=p.getElementsByTagName("body")[0],fb=xa(i);fb.setAttribute("type",l);fb.setAttribute('style','visibility: hidden; position: absolute; top: -1000px;');var gb=eb.appendChild(fb);if(gb){var hb=0;(function(){if(typeof gb.GetVariable!=h){var ib=gb.GetVariable("$version");if(ib){ib=ib.split(" ")[1].split(",");fa.pv=[parseInt(ib[0],10),parseInt(ib[1],10),parseInt(ib[2],10)];}}else if(hb<10){hb++;setTimeout(arguments.callee,10);return;}gb=null;ma();})();}else ma();}function ma(){var eb=t.length;if(eb>0)for(var fb=0;fb<eb;fb++){var gb=t[fb].id,hb=t[fb].callbackFn,ib={success:false,id:gb};if(fa.pv[0]>0){var jb=wa(gb);if(jb)if(za(t[fb].swfVersion)&&!(fa.wk&&fa.wk<312)){bb(gb,true);if(hb){ib.success=true;ib.ref=na(gb);hb(ib);}}else if(t[fb].expressInstall&&oa()){var kb={};kb.data=t[fb].expressInstall;kb.width=jb.getAttribute("width")||"0";kb.height=jb.getAttribute("height")||"0";if(jb.getAttribute("class"))kb.styleclass=jb.getAttribute("class");if(jb.getAttribute("align"))kb.align=jb.getAttribute("align");var lb={},mb=jb.getElementsByTagName("param"),nb=mb.length;for(var ob=0;ob<nb;ob++)if(mb[ob].getAttribute("name").toLowerCase()!="movie")lb[mb[ob].getAttribute("name")]=mb[ob].getAttribute("value");pa(kb,lb,gb,hb);}else{qa(jb);if(hb)hb(ib);}}else{bb(gb,true);if(hb){var pb=na(gb);if(pb&&typeof pb.SetVariable!=h){ib.success=true;ib.ref=pb;}hb(ib);}}}}function na(eb){var fb=null,gb=wa(eb);if(gb&&gb.nodeName=="OBJECT")if(typeof gb.SetVariable!=h){fb=gb;}else{var hb=gb.getElementsByTagName(i)[0];if(hb)fb=hb;}return fb;}function oa(){return !ba&&za("6.0.65")&&(fa.win||fa.mac)&&!(fa.wk&&fa.wk<312);}function pa(eb,fb,gb,hb){ba=true;y=hb||null;z={success:false,id:gb};var ib=wa(gb);if(ib){if(ib.nodeName=="OBJECT"){w=ra(ib);x=null;}else{w=ib;x=gb;}eb.id=m;if(typeof eb.width==h||(!/%$/.test(eb.width)&&parseInt(eb.width,10)<310))eb.width="310";if(typeof eb.height==h||(!/%$/.test(eb.height)&&parseInt(eb.height,10)<137))eb.height="137";p.title=p.title.slice(0,47)+" - Flash Player Installation";var jb=fa.ie&&fa.win?"ActiveX":"PlugIn",kb="MMredirectURL="+o.location.toString().replace(/&/g,"%26")+"&MMplayerType="+jb+"&MMdoctitle="+p.title;if(typeof fb.flashvars!=h){fb.flashvars+="&"+kb;}else fb.flashvars=kb;if(fa.ie&&fa.win&&ib.readyState!=4){var lb=xa("div");gb+="SWFObjectNew";lb.setAttribute("id",gb);ib.parentNode.insertBefore(lb,ib);ib.style.display="none";(function(){if(ib.readyState==4){ib.parentNode.removeChild(ib);}else setTimeout(arguments.callee,10);})();}sa(eb,fb,gb);}}function qa(eb){if(fa.ie&&fa.win&&eb.readyState!=4){var fb=xa("div");eb.parentNode.insertBefore(fb,eb);fb.parentNode.replaceChild(ra(eb),fb);eb.style.display="none";(function(){if(eb.readyState==4){eb.parentNode.removeChild(eb);}else setTimeout(arguments.callee,10);})();}else eb.parentNode.replaceChild(ra(eb),eb);}function ra(eb){var fb=xa("div");if(fa.win&&fa.ie){fb.innerHTML=eb.innerHTML;}else{var gb=eb.getElementsByTagName(i)[0];if(gb){var hb=gb.childNodes;if(hb){var ib=hb.length;for(var jb=0;jb<ib;jb++)if(!(hb[jb].nodeType==1&&hb[jb].nodeName=="PARAM")&&!(hb[jb].nodeType==8))fb.appendChild(hb[jb].cloneNode(true));}}}return fb;}function sa(eb,fb,gb){var hb,ib=wa(gb);if(fa.wk&&fa.wk<312)return hb;if(ib){if(typeof eb.id==h)eb.id=gb;if(fa.ie&&fa.win){var jb="";for(var kb in eb)if(eb[kb]!=Object.prototype[kb])if(kb.toLowerCase()=="data"){fb.movie=eb[kb];}else if(kb.toLowerCase()=="styleclass"){jb+=' class="'+eb[kb]+'"';}else if(kb.toLowerCase()!="classid")jb+=' '+kb+'="'+eb[kb]+'"';var lb="";for(var mb in fb)if(fb[mb]!=Object.prototype[mb])lb+='<param name="'+mb+'" value="'+fb[mb]+'" />';ib.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+jb+'>'+lb+'</object>';u[u.length]=eb.id;hb=wa(eb.id);}else{var nb=xa(i);nb.setAttribute("type",l);for(var ob in eb)if(eb[ob]!=Object.prototype[ob])if(ob.toLowerCase()=="styleclass"){nb.setAttribute("class",eb[ob]);}else if(ob.toLowerCase()!="classid")nb.setAttribute(ob,eb[ob]);for(var pb in fb)if(fb[pb]!=Object.prototype[pb]&&pb.toLowerCase()!="movie")ta(nb,pb,fb[pb]);ib.parentNode.replaceChild(nb,ib);hb=nb;}}return hb;}function ta(eb,fb,gb){var hb=xa("param");hb.setAttribute("name",fb);hb.setAttribute("value",gb);eb.appendChild(hb);}function ua(eb){var fb=wa(eb);if(fb&&fb.nodeName=="OBJECT")if(fa.ie&&fa.win){fb.style.display="none";(function(){if(fb.readyState==4){va(eb);}else setTimeout(arguments.callee,10);})();}else fb.parentNode.removeChild(fb);}function va(eb){var fb=wa(eb);if(fb){for(var gb in fb)if(typeof fb[gb]=="function")fb[gb]=null;fb.parentNode.removeChild(fb);}}function wa(eb){var fb=null;try{fb=p.getElementById(eb);}catch(gb){}return fb;}function xa(eb){return p.createElement(eb);}function ya(eb,fb,gb){eb.attachEvent(fb,gb);v[v.length]=[eb,fb,gb];}function za(eb){var fb=fa.pv,gb=eb.split(".");gb[0]=parseInt(gb[0],10);gb[1]=parseInt(gb[1],10)||0;gb[2]=parseInt(gb[2],10)||0;return (fb[0]>gb[0]||(fb[0]==gb[0]&&fb[1]>gb[1])||(fb[0]==gb[0]&&fb[1]==gb[1]&&fb[2]>=gb[2]))?true:false;}function ab(eb,fb,gb,hb){if(fa.ie&&fa.mac)return;var ib=p.getElementsByTagName("head")[0];if(!ib)return;var jb=(gb&&typeof gb=="string")?gb:"screen";if(hb){ca=null;da=null;}if(!ca||da!=jb){var kb=xa("style");kb.setAttribute("type","text/css");kb.setAttribute("media",jb);ca=ib.appendChild(kb);if(fa.ie&&fa.win&&typeof p.styleSheets!=h&&p.styleSheets.length>0)ca=p.styleSheets[p.styleSheets.length-1];da=jb;}if(fa.ie&&fa.win){if(ca&&typeof ca.addRule==i)ca.addRule(eb,fb);}else if(ca&&typeof p.createTextNode!=h)ca.appendChild(p.createTextNode(eb+" {"+fb+"}"));}function bb(eb,fb){if(!ea)return;var gb=fb?"visible":"hidden";if(aa&&wa(eb)){wa(eb).style.visibility=gb;}else ab("#"+eb,"visibility:"+gb);}function cb(eb){var fb=/[\\\"<>\.;]/,gb=fb.exec(eb)!=null;return gb&&typeof encodeURIComponent!=h?encodeURIComponent(eb):eb;}var db=function(){if(fa.ie&&fa.win)window.attachEvent("onunload",function(){var eb=v.length;for(var fb=0;fb<eb;fb++)v[fb][0].detachEvent(v[fb][1],v[fb][2]);var gb=u.length;for(var hb=0;hb<gb;hb++)ua(u[hb]);for(var ib in fa)fa[ib]=null;fa=null;for(var jb in g)g[jb]=null;g=null;});}();return {registerObject:function(eb,fb,gb,hb){if(fa.w3&&eb&&fb){var ib={};ib.id=eb;ib.swfVersion=fb;ib.expressInstall=gb;ib.callbackFn=hb;t[t.length]=ib;bb(eb,false);}else if(hb)hb({success:false,id:eb});},getObjectById:function(eb){if(fa.w3)return na(eb);},embedSWF:function(eb,fb,gb,hb,ib,jb,kb,lb,mb,nb){var ob={success:false,id:fb};if(fa.w3&&!(fa.wk&&fa.wk<312)&&eb&&fb&&gb&&hb&&ib){bb(fb,false);ia(function(){gb+="";hb+="";var pb={};if(mb&&typeof mb===i)for(var qb in mb)pb[qb]=mb[qb];pb.data=eb;pb.width=gb;pb.height=hb;var rb={};if(lb&&typeof lb===i)for(var sb in lb)rb[sb]=lb[sb];if(kb&&typeof kb===i)for(var tb in kb)if(typeof rb.flashvars!=h){rb.flashvars+="&"+tb+"="+kb[tb];}else rb.flashvars=tb+"="+kb[tb];if(za(ib)){var ub=sa(pb,rb,fb);if(pb.id==fb)bb(fb,true);ob.success=true;ob.ref=ub;}else if(jb&&oa()){pb.data=jb;pa(pb,rb,fb,nb);return;}else bb(fb,true);if(nb)nb(ob);});}else if(nb)nb(ob);},switchOffAutoHideShow:function(){ea=false;},ua:fa,getFlashPlayerVersion:function(){return {major:fa.pv[0],minor:fa.pv[1],release:fa.pv[2]};},hasFlashPlayerVersion:za,createSWF:function(eb,fb,gb){if(fa.w3){return sa(eb,fb,gb);}else return undefined;},showExpressInstall:function(eb,fb,gb,hb){if(fa.w3&&oa())pa(eb,fb,gb,hb);},removeSWF:function(eb){if(fa.w3)ua(eb);},createCSS:function(eb,fb,gb,hb){if(fa.w3)ab(eb,fb,gb,hb);},addDomLoadEvent:ia,addLoadEvent:ja,getQueryParamValue:function(eb){var fb=p.location.search||p.location.hash;if(fb){if(/\?/.test(fb))fb=fb.split("?")[1];if(eb==null)return cb(fb);var gb=fb.split("&");for(var hb=0;hb<gb.length;hb++)if(gb[hb].substring(0,gb[hb].indexOf("="))==eb)return cb(gb[hb].substring((gb[hb].indexOf("=")+1)));}return "";},expressInstallCallback:function(){if(ba){var eb=wa(m);if(eb&&w){eb.parentNode.replaceChild(w,eb);if(x){bb(x,true);if(fa.ie&&fa.win)w.style.display="block";}if(y)y(z);}ba=false;}}};}();e.exports=g;});
__d("SoundPlayer",["Arbiter","ChatConfig","swfobject","swfobject2","URI","createArrayFrom"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ChatConfig'),i=b('swfobject').SWFObject,j=b('swfobject2'),k=b('URI'),l=b('createArrayFrom'),m={},n=null,o=false,p='so_sound_player',q='/swf/SoundPlayer.swf?v=1',r='10.0.22.87',s=null,t=h.get('sound.useswfobject_2',false),u=h.get('sound.force_flash',false);function v(da){var ea=k(da);if(!ea.getDomain())return k().setPath(ea.getPath()).toString();return da;}function w(da){var ea=k(da).getPath();if(/\.mp3$/.test(ea))return 'audio/mpeg';if(/\.og[ga]$/.test(ea))return 'audio/ogg';return '';}function x(){if(!s&&!u){var da=document.createElement('audio');if(!da||!da.canPlayType)return null;da.setAttribute('preload','auto');document.body.appendChild(da);s=da;}return s;}function y(){var da=document[p]||window[p];if(da)if(!da.playSound&&da.length)da=da[0];return (da&&da.playSound&&da.loopSound)?da:null;}function z(){return o;}function aa(da,ea,fa){n={path:da,sync:ea,loop:fa};}function ba(){o=true;if(n){var da=y();if(n.loop){da.loopSound(n.path,n.sync);}else da.playSound(n.path,n.sync);}}var ca={init:function(da){da=l(da);var ea;for(var fa=0;fa<da.length;++fa){ea=da[fa];if(m[ea])return;}var ga=x();for(fa=0;ga&&fa<da.length;++fa){ea=da[fa];if(ga.canPlayType(ea)){m[ea]=true;return;}}m['audio/mpeg']=true;if(y())return;try{g.registerCallback(ba,['sound/player_ready','sound/ready']);var ia=document.createElement('div');ia.id='sound_player_holder';document.body.appendChild(ia);if(t){j.embedSWF(q,ia.id,'1px','1px',r,null,{swf_id:p},{allowscriptaccess:'always',wmode:'transparent'},null,function(ka){window[p]=ka.ref;g.inform('sound/player_ready');});}else{var ja=new i(q,p,'1px','1px',[r],'#ffffff');ja.addParam('allowscriptaccess','always');ja.addParam('wmode','transparent');ja.addVariable('swf_id',p);ja.fallback_html=' ';ja.write(ia.id);window[p]=ja;g.inform('sound/player_ready');}}catch(ha){}},play:function(da,ea){da=l(da);var fa=x(),ga,ha;for(var ia=0;fa&&ia<da.length;++ia){ga=da[ia];ha=w(ga);if(!fa.canPlayType(ha))continue;ca.init([ha]);fa.src=v(ga);if(ea){fa.setAttribute('loop','');}else fa.removeAttribute('loop');fa.play();return;}for(ia=0;ia<da.length;++ia){ga=v(da[ia]);ha=w(ga);if(ha!='audio/mpeg')continue;ca.init([ha]);var ja=y();if(!z()){aa(ga,true,ea);return;}else if(ja){if(ea){ja.loopSound(ga,true);}else ja.playSound(ga,true);return;}}},stop:function(da){da=l(da);for(var ea=0;ea<da.length;++ea){var fa=v(da[ea]),ga=x(),ha=y();if(ga&&ga.src==fa){ga.pause();ga.src=undefined;}else ha&&ha.stopSound(fa);}}};e.exports=ca;});
__d("SoundSynchronizer",["hasArrayNature","SoundPlayer","createArrayFrom"],function(a,b,c,d,e,f){var g=b('hasArrayNature'),h=b('SoundPlayer'),i=b('createArrayFrom'),j='fb_sounds_playing3';function k(){if(window.localStorage)try{var p=window.localStorage[j];if(p){p=JSON.parse(p);if(g(p))return p;}}catch(o){}return [];}function l(o){if(window.localStorage){var p=k();p.push(o);while(p.length>5)p.shift();try{window.localStorage[j]=JSON.stringify(p);}catch(q){}}}function m(o){return k().some(function(p){return p===o;});}var n={play:function(o,p,q){o=i(o);p=p||(o[0]+Math.floor(Date.now()/1000));if(m(p))return;h.play(o,q);l(p);},isSupported:function(){return !!window.localStorage;}};e.exports=n;});
__d("SoundRPC",["Event","SoundSynchronizer"],function(a,b,c,d,e,f){var g=b('Event'),h=b('SoundSynchronizer');function i(k,l,m){h.play(k,l,m);}var j={playLocal:i,playRemote:function(k,l,m,n){var o={paths:l,sync:m,loop:n};k.postMessage(JSON.stringify(o),'*');},supportsRPC:function(){return !!window.postMessage;},_listen:function(){g.listen(window,'message',function(k){if(!/\.facebook.com$/.test(k.origin))return;var l=JSON.parse(k.data);i(l.paths,l.sync,l.loop);});}};e.exports=j;});
__d("Sound",["SoundPlayer","SoundRPC","SoundSynchronizer","URI","UserAgent"],function(a,b,c,d,e,f){var g=b('SoundPlayer'),h=b('SoundRPC'),i=b('SoundSynchronizer'),j=b('URI'),k=b('UserAgent'),l=null,m={init:function(q){if(!l)g.init(q);},play:function(q,r,s){if(l){h.playRemote(l.contentWindow,q,r,false);}else h.playLocal(q,r,s);},stop:function(q){if(!l)g.stop(q);}},n=new j(location.href);if(n.getSubdomain()&&n.getSubdomain()!=='www')n.setSubdomain('www');var o=n.getDomain();function p(){if(k.ie()<9)return false;return i.isSupported()&&h.supportsRPC();}if(n.isFacebookURI()&&location.host!==o&&p()){l=document.createElement('iframe');l.setAttribute('src','//'+o+'/sound_iframe.php');l.style.display='none';document.body.appendChild(l);}e.exports=m;});
__d("PhotosUploadWaterfall",["AsyncSignal"],function(a,b,c,d,e,f){var g=b('AsyncSignal'),h={APP_FLASH:'flash_pro',APP_SIMPLE:'simple',APP_ARCHIVE:'archive',APP_COMPOSER:'composer',APP_MESSENGER:'messenger',APP_HTML5:'html5',APP_CHAT:'chat',INSTALL_CANCEL:1,INSTALL_INSTALL:2,INSTALL_UPDATE:3,INSTALL_REINSTALL:4,INSTALL_PERMA_CANCEL:5,INSTALL_SILENT_SKIP:6,INSTALL_DOWNLOAD:7,CERROR_RESIZING_FAILED:6,CERROR_MARKER_EXTRACTION_FAILED:9,BEGIN:1,UPLOAD_START:4,ALL_UPLOADS_DONE:6,CLIENT_ERROR:7,RECOVERABLE_CLIENT_ERROR:12,IMAGES_SELECTED:9,UPGRADE_REQUIRED:11,VERSION:15,SELECT_START:18,SELECT_CANCELED:19,CANCEL:22,CANCEL_DURING_UPLOAD:83,ONE_UPLOAD_DONE:29,ONE_RESIZING_DONE:34,PROGRESS_BAR_STOPPED:44,MISSED_BEAT:45,HEART_ATTACK:46,PUBLISH_START:100,PUBLISH_SUCCESS:101,PUBLISH_FAILURE:102,SESSION_POSTED:72,POST_PUBLISHED:80,ONE_UPLOAD_CANCELED:81,ONE_UPLOAD_CANCELED_DURING_UPLOAD:82,RESIZER_AVAILABLE:20,OVERLAY_FIRST:61,ASYNC_AVAILABLE:63,FALLBACK_TO_FLASH:13,RETRY_UPLOAD:17,TAGGED_ALL_FACES:14,VAULT_IMAGES_SELECTED:62,VAULT_CREATE_POST_CANCEL:65,VAULT_SEND_IN_MESSAGE_CLICKED:66,VAULT_DELETE_CANCEL:68,VAULT_ADD_TO_ALBUM_CANCEL:74,VAULT_SHARE_IN_AN_ALBUM_CLICKED:76,VAULT_SHARE_OWN_TIMELINE_CLICKED:77,VAULT_SHARE_FRIENDS_TIMELINE_CLICKED:78,VAULT_SHARE_IN_A_GROUP_CLICKED:79,METHOD_DRAGDROP:'dragdrop',METHOD_FILE_SELECTOR:'file_selector',METHOD_VAULT:'vault',METHOD_PHOTOS_OF_YOU:'photos_of_you',METHOD_RECENT_PHOTOS:'recent_photos',VAULTBOX:'vaultbox',GRID:'grid',SPOTLIGHT_VAULT_VIEWER:'spotlight_vault_viewer',sendSignal:function(i,j){new g('/ajax/photos/waterfall.php',{data:JSON.stringify(i)}).setHandler(j).send();}};e.exports=h;});